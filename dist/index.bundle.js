"use strict";(self.webpackChunktodo_list=self.webpackChunktodo_list||[]).push([[826],{852:(e,t,r)=>{function n(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var o=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,o=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],i=!1,a="",s=(e=e.trim()).length;if(t&&e.length<=0)return{isError:i=!0,msg:a="This field is Required!"};if(r>0&&s<r)return{isError:i=!0,msg:a="The min character length of this field is ".concat(r)};if(n>0&&s>n)return{isError:i=!0,msg:a="The max character length of this field is ".concat(n)};if(!o){var c=e.replace(/\s/g,""),l=/^[A-Za-z][A-Za-z0-9-_.]*$/;if(!l.test(c))return{isError:i=!0,msg:a="This field is only allow A-z0-9_.- characters and also first character should be A-z"}}return{isError:i,msg:a}},i=document.getElementById("description"),a=document.querySelector(".show-msg"),s=document.querySelector(".btn-submit"),c=document.querySelector(".todo-items-gropu"),l=(document.querySelectorAll(".todo-des"),document.querySelector(".btn-clear-all"));const d=r.p+"images/three-dot-24.png",u=r.p+"images/trash-24.png";function m(e){return m="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},m(e)}function f(e){return function(e){if(Array.isArray(e))return p(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return p(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?p(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function p(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function v(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,h(n.key),n)}}function g(e,t,r){return t&&v(e.prototype,t),r&&v(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function y(e,t,r){return(t=h(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function h(e){var t=function(e,t){if("object"!==m(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,"string");if("object"!==m(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===m(t)?t:String(t)}var b=g((function e(){var t=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),y(this,"sortAndSave",(function(){var e=f(t.todos);e.sort((function(e,t){return e.index>t.index?1:e.index<t.index?-1:0}));var r=0;e.forEach((function(e){r+=1,e.index=r})),t.todos=f(e),localStorage.setItem("todos",JSON.stringify(t.todos))})),y(this,"render",(function(){c.innerHTML="",a.innerText="",a.classList.remove("form-error"),t.sortAndSave(),t.todos.length>0?t.todos.forEach((function(e){var r=document.createElement("li");r.id=e.index,r.className="todo-item",r.setAttribute("draggable",!0),r.addEventListener("dragstart",(function(){r.classList.add("dragging")})),r.addEventListener("dragend",(function(){r.classList.remove("dragging")}));var n=document.createElement("input");n.setAttribute("type","checkbox"),n.id="todo-compleate",n.addEventListener("change",(function(e){t.onCompleate(e)}));var o=document.createElement("p");o.className="todo-des",o.innerText=e.description,e.completed&&(n.setAttribute("checked","yes"),o.classList.add("todo-compleated"));var i=document.createElement("button");i.className="btn-three-dot",i.innerHTML='<img src="'.concat(d,'" alt="...">'),i.addEventListener("click",(function(e){t.onClickTodoDes(e)})),r.append(n,o,i),c.appendChild(r)})):c.innerHTML='<p class="no-item">There is no todo to show! Please add a new one.</p>'})),y(this,"onSubmit",(function(){var e=i.value,r=o(e,!0,3,255,!1);if(!0===r.isError&&r.msg.length>=0)a.classList.add("form-error"),a.textContent=r.msg,i.classList.add("invalid");else{a.classList.remove("form-error"),a.textContent="",i.classList.remove("invalid"),i.value="";var n={description:e,completed:!1,index:t.todos.length+1||1};t.todos=[].concat(f(t.todos),[n]),t.render()}})),y(this,"delete",(function(e){t.todos=t.todos.filter((function(t){return t.index.toString()!==e})),t.render()})),y(this,"edit",(function(e){var r=e.target.value,n=o(r,!0,3,255,!1);if(!0===n.isError&&n.msg.length>0)a.classList.add("form-error"),a.textContent=n.msg,e.target.classList.add("invalid-edit");else{e.target.classList.remove("invalid-edit");var i=e.target.parentElement.id,s=f(t.todos),c=s.findIndex((function(e){return i===e.index.toString()}));c>=0&&(s[c].description=r),t.todos=f(s),t.render()}})),y(this,"onClickTodoDes",(function(e){var r=e.target.parentElement.parentElement,n=r.querySelector(".todo-des").innerText;r.innerHTML="";var o=document.createElement("input");o.setAttribute("type","checkbox"),o.id="todo-compleate",o.addEventListener("change",(function(e){t.onCompleate(e)}));var i=document.createElement("input");i.setAttribute("type","text"),i.setAttribute("value",n),i.className="todo-edit-input",i.addEventListener("keypress",(function(e){"Enter"===e.key?(e.preventDefault(),t.edit(e)):(a.classList.remove("form-error"),a.innerText="",e.target.classList.remove("invalid-edit"))}));var s=document.createElement("button");s.className="btn-delete",s.innerHTML='<img src="'.concat(u,'" alt="X">'),s.addEventListener("click",(function(){var e=r.id;t.delete(e)})),r.append(o,i,s)})),y(this,"onCompleate",(function(e){var r=e.target.parentElement.id,n=f(t.todos),o=n.findIndex((function(e){return r===e.index.toString()}));o>=0&&(n[o].completed=!n[o].completed),t.todos=f(n),t.render()})),y(this,"onFilterCompletedTodos",(function(){var e=f(t.todos);e=e.filter((function(e){return!0!==e.completed})),t.todos=f(e),t.render()})),localStorage.getItem("todos")?this.todos=JSON.parse(localStorage.getItem("todos")):this.todos=[]}));const E=r.p+"images/enter-24.png";var S=new b;i.addEventListener("keypress",(function(e){"Enter"===e.key?(e.preventDefault(),S.onSubmit()):(a.innerHTML="",a.classList.remove("form-error"),i.classList.remove("invalid"))})),s.addEventListener("click",(function(e){e.preventDefault(),S.onSubmit()})),l.addEventListener("click",(function(){S.onFilterCompletedTodos()})),c.addEventListener("dragover",(function(e){e.preventDefault();var t=function(e,t){return(r=e.querySelectorAll(".todo-item:not(.dragging)"),function(e){if(Array.isArray(e))return n(e)}(r)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(r)||function(e,t){if(e){if("string"==typeof e)return n(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?n(e,t):void 0}}(r)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()).reduce((function(e,r){var n=r.getBoundingClientRect(),o=t-n.top-n.height/2;return o<0&&o>e.offset?{offset:o,element:r}:e}),{offset:Number.NEGATIVE_INFINITY}).element;var r}(c,e.clientY),r=c.querySelector(".dragging");null==r?c.appendChild(r):c.insertBefore(r,t)})),window.onload=function(){S.render(),document.querySelector(".btn-submit").innerHTML="<img src='".concat(E,"' alt='submit'/>")}}},e=>{e(e.s=852)}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QSxFQUFFMkIsaUJBQ0YsSUFBTVMsRUhLdUIsU0FBQ2pFLEVBQWVrRSxHQUc3QyxPLEVBRitCbEUsRUFBY0UsaUJBQWlCLDZCLGtuQkFFcENpRSxRQUFPLFNBQUNDLEVBQVNqQixHQUV6QyxJQUFNa0IsRUFBTWxCLEVBQUttQix3QkFHWEMsRUFBU0wsRUFBSUcsRUFBSUcsSUFBTUgsRUFBSUksT0FBUyxFQUMxQyxPQUFJRixFQUFTLEdBQUtBLEVBQVNILEVBQVFHLE9BQzFCLENBQUVBLE9BQUFBLEVBQVFHLFFBQVN2QixHQUVyQmlCLENBQ1QsR0FBRyxDQUFFRyxPQUFRSSxPQUFPQyxvQkFBcUJGLFEsS0FDM0MsQ0duQmtDRyxDQUFnQjdFLEVBQWU2QixFQUFFaUQsU0FDM0RDLEVBQVcvRSxFQUFjRixjQUFjLGFBRTdCLE1BQVppRixFQUNGL0UsRUFBY3NDLFlBQVl5QyxHQUUxQi9FLEVBQWNnRixhQUFhRCxFQUFVZCxFQUV6QyxJQUdBZ0IsT0FBT0MsT0FBUyxXQUNkN0UsRUFBTXFDLFNBQ04vQyxTQUFTRyxjQUFjLGVBQWVrQixVQUFZLGFBQUgsT0FBZ0JtRSxFQUFTLG1CQUMxRSxDIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vdG9kby1saXN0Ly4vc3JjL21vZHVsZXMvdXRpbHMuanMiLCJ3ZWJwYWNrOi8vdG9kby1saXN0Ly4vc3JjL21vZHVsZXMvZG9tU2VsZWN0b3IuanMiLCJ3ZWJwYWNrOi8vdG9kby1saXN0Ly4vc3JjL21vZHVsZXMvdG9kb3MuanMiLCJ3ZWJwYWNrOi8vdG9kby1saXN0Ly4vc3JjL2luZGV4LmpzIl0sInNvdXJjZXNDb250ZW50IjpbImV4cG9ydCBjb25zdCB2YWxpZGF0ZUZvcm0gPSAoXG4gIHN0ciwgcmVxdWlyZWQgPSBmYWxzZSwgbWluTGVuZ3RoID0gMCwgbWF4TGVuZ3RoID0gMCwgc3BlY2lhbENoYXIgPSB0cnVlLFxuKSA9PiB7XG4gIGxldCBpc0Vycm9yID0gZmFsc2U7XG4gIGxldCBtc2cgPSAnJztcbiAgc3RyID0gc3RyLnRyaW0oKTtcbiAgY29uc3QgbGVuID0gc3RyLmxlbmd0aDtcblxuICBpZiAocmVxdWlyZWQpIHtcbiAgICBpZiAoc3RyLmxlbmd0aCA8PSAwKSB7XG4gICAgICBpc0Vycm9yID0gdHJ1ZTtcbiAgICAgIG1zZyA9ICdUaGlzIGZpZWxkIGlzIFJlcXVpcmVkISc7XG4gICAgICByZXR1cm4geyBpc0Vycm9yLCBtc2cgfTtcbiAgICB9XG4gIH1cblxuICBpZiAobWluTGVuZ3RoID4gMCkge1xuICAgIGlmIChsZW4gPCBtaW5MZW5ndGgpIHtcbiAgICAgIGlzRXJyb3IgPSB0cnVlO1xuICAgICAgbXNnID0gYFRoZSBtaW4gY2hhcmFjdGVyIGxlbmd0aCBvZiB0aGlzIGZpZWxkIGlzICR7bWluTGVuZ3RofWA7XG4gICAgICByZXR1cm4geyBpc0Vycm9yLCBtc2cgfTtcbiAgICB9XG4gIH1cblxuICBpZiAobWF4TGVuZ3RoID4gMCkge1xuICAgIGlmIChsZW4gPiBtYXhMZW5ndGgpIHtcbiAgICAgIGlzRXJyb3IgPSB0cnVlO1xuICAgICAgbXNnID0gYFRoZSBtYXggY2hhcmFjdGVyIGxlbmd0aCBvZiB0aGlzIGZpZWxkIGlzICR7bWF4TGVuZ3RofWA7XG4gICAgICByZXR1cm4geyBpc0Vycm9yLCBtc2cgfTtcbiAgICB9XG4gIH1cblxuICBpZiAoIXNwZWNpYWxDaGFyKSB7XG4gICAgY29uc3QgbmV3U3RyID0gc3RyLnJlcGxhY2UoL1xccy9nLCAnJyk7XG4gICAgY29uc3QgcmUgPSAvXltBLVphLXpdW0EtWmEtejAtOS1fLl0qJC87XG4gICAgaWYgKCFyZS50ZXN0KG5ld1N0cikpIHtcbiAgICAgIGlzRXJyb3IgPSB0cnVlO1xuICAgICAgbXNnID0gJ1RoaXMgZmllbGQgaXMgb25seSBhbGxvdyBBLXowLTlfLi0gY2hhcmFjdGVycyBhbmQgYWxzbyBmaXJzdCBjaGFyYWN0ZXIgc2hvdWxkIGJlIEEteic7XG4gICAgICByZXR1cm4geyBpc0Vycm9yLCBtc2cgfTtcbiAgICB9XG4gIH1cbiAgcmV0dXJuIHsgaXNFcnJvciwgbXNnIH07XG59O1xuXG5leHBvcnQgY29uc3QgZ2V0QWZ0ZXJFbGVtZW50ID0gKHRvZG9Db250YWluZXIsIHkpID0+IHtcbiAgY29uc3QgZHJhZ0ZpbHRlckVsZW1lbnRzID0gWy4uLnRvZG9Db250YWluZXIucXVlcnlTZWxlY3RvckFsbCgnLnRvZG8taXRlbTpub3QoLmRyYWdnaW5nKScpXTtcblxuICByZXR1cm4gZHJhZ0ZpbHRlckVsZW1lbnRzLnJlZHVjZSgobmVhcmVzdCwgaXRlbSkgPT4ge1xuICAgIC8vIGdldCB0aGUgYm94IGNvbnRlbnRcbiAgICBjb25zdCBib3ggPSBpdGVtLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpO1xuXG4gICAgLy8gY2FsY3VsYXRlIHRoZSBvZmZzZXRcbiAgICBjb25zdCBvZmZzZXQgPSB5IC0gYm94LnRvcCAtIGJveC5oZWlnaHQgLyAyO1xuICAgIGlmIChvZmZzZXQgPCAwICYmIG9mZnNldCA+IG5lYXJlc3Qub2Zmc2V0KSB7XG4gICAgICByZXR1cm4geyBvZmZzZXQsIGVsZW1lbnQ6IGl0ZW0gfTtcbiAgICB9XG4gICAgcmV0dXJuIG5lYXJlc3Q7XG4gIH0sIHsgb2Zmc2V0OiBOdW1iZXIuTkVHQVRJVkVfSU5GSU5JVFkgfSkuZWxlbWVudDtcbn07IiwiZXhwb3J0IGNvbnN0IGZvcm1JbnB1dCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdkZXNjcmlwdGlvbicpO1xuZXhwb3J0IGNvbnN0IHNob3dNc2cgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuc2hvdy1tc2cnKTtcbmV4cG9ydCBjb25zdCBidG5TdWJtaXQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuYnRuLXN1Ym1pdCcpO1xuZXhwb3J0IGNvbnN0IHRvZG9Db250YWluZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcudG9kby1pdGVtcy1ncm9wdScpO1xuZXhwb3J0IGNvbnN0IHRvZG9JdGVtc0RlcyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy50b2RvLWRlcycpO1xuZXhwb3J0IGNvbnN0IGZpbHRlckJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5idG4tY2xlYXItYWxsJyk7IiwiaW1wb3J0IHsgdmFsaWRhdGVGb3JtIH0gZnJvbSAnLi91dGlscy5qcyc7XG5pbXBvcnQgeyB0b2RvQ29udGFpbmVyLCBmb3JtSW5wdXQsIHNob3dNc2cgfSBmcm9tICcuL2RvbVNlbGVjdG9yLmpzJztcblxuLy8gSW1wb3J0IG5lY2Vzc2FyeSBhc3NldHMgZm9ybSBzb3VyY2VcbmltcG9ydCB0aHJlZURvdEljb24gZnJvbSAnLi4vYXNzZXRzL3RocmVlLWRvdC0yNC5wbmcnO1xuaW1wb3J0IGRlbGV0ZUljb24gZnJvbSAnLi4vYXNzZXRzL3RyYXNoLTI0LnBuZyc7XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFRvZG9zIHtcbiAgY29uc3RydWN0b3IoKSB7XG4gICAgaWYgKGxvY2FsU3RvcmFnZS5nZXRJdGVtKCd0b2RvcycpKSB7XG4gICAgICB0aGlzLnRvZG9zID0gSlNPTi5wYXJzZShsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgndG9kb3MnKSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMudG9kb3MgPSBbXTtcbiAgICB9XG4gIH1cblxuICBzb3J0QW5kU2F2ZSA9ICgpID0+IHtcbiAgICBjb25zdCB0b2RvQXJyID0gWy4uLnRoaXMudG9kb3NdO1xuICAgIC8vIHNvcnRpbmcgdGhlIGxpc3RcbiAgICB0b2RvQXJyLnNvcnQoKGEsIGIpID0+IHtcbiAgICAgIGlmIChhLmluZGV4ID4gYi5pbmRleCkge1xuICAgICAgICByZXR1cm4gMTtcbiAgICAgIH0gaWYgKGEuaW5kZXggPCBiLmluZGV4KSB7XG4gICAgICAgIHJldHVybiAtMTtcbiAgICAgIH1cbiAgICAgIHJldHVybiAwO1xuICAgIH0pO1xuXG4gICAgLy8gcmVhcnJhbmdlIHRoZSBpbmRleFxuICAgIGxldCBpbmRleCA9IDA7XG4gICAgdG9kb0Fyci5mb3JFYWNoKCh0b2RvKSA9PiB7XG4gICAgICBpbmRleCArPSAxO1xuICAgICAgdG9kby5pbmRleCA9IGluZGV4O1xuICAgIH0pO1xuXG4gICAgdGhpcy50b2RvcyA9IFsuLi50b2RvQXJyXTtcbiAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbSgndG9kb3MnLCBKU09OLnN0cmluZ2lmeSh0aGlzLnRvZG9zKSk7XG4gIH1cblxuICAvLyBSZW5kZXIgdG9kbyBsaXN0XG4gIHJlbmRlciA9ICgpID0+IHtcbiAgICB0b2RvQ29udGFpbmVyLmlubmVySFRNTCA9ICcnO1xuICAgIHNob3dNc2cuaW5uZXJUZXh0ID0gJyc7XG4gICAgc2hvd01zZy5jbGFzc0xpc3QucmVtb3ZlKCdmb3JtLWVycm9yJyk7XG4gICAgdGhpcy5zb3J0QW5kU2F2ZSgpO1xuICAgIGlmICh0aGlzLnRvZG9zLmxlbmd0aCA+IDApIHtcbiAgICAgIHRoaXMudG9kb3MuZm9yRWFjaCgodG9kbykgPT4ge1xuICAgICAgLy8gY3JlYXRlIHRvZG8gaXRlbVxuICAgICAgICBjb25zdCB0b2RvSXRlbSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2xpJyk7XG4gICAgICAgIHRvZG9JdGVtLmlkID0gdG9kby5pbmRleDtcbiAgICAgICAgdG9kb0l0ZW0uY2xhc3NOYW1lID0gJ3RvZG8taXRlbSc7XG4gICAgICAgIHRvZG9JdGVtLnNldEF0dHJpYnV0ZSgnZHJhZ2dhYmxlJywgdHJ1ZSk7XG5cbiAgICAgICAgLy8gZHJhZyBhbmQgZHJvcCBmdW5jdGlvbjtcbiAgICAgICAgdG9kb0l0ZW0uYWRkRXZlbnRMaXN0ZW5lcignZHJhZ3N0YXJ0JywgKCkgPT4ge1xuICAgICAgICAgIHRvZG9JdGVtLmNsYXNzTGlzdC5hZGQoJ2RyYWdnaW5nJyk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIHRvZG9JdGVtLmFkZEV2ZW50TGlzdGVuZXIoJ2RyYWdlbmQnLCAoKSA9PiB7XG4gICAgICAgICAgdG9kb0l0ZW0uY2xhc3NMaXN0LnJlbW92ZSgnZHJhZ2dpbmcnKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgLy8gdG9kbyBjaGVja2JveFxuICAgICAgICBjb25zdCBjaGVja2JveCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2lucHV0Jyk7XG4gICAgICAgIGNoZWNrYm94LnNldEF0dHJpYnV0ZSgndHlwZScsICdjaGVja2JveCcpO1xuICAgICAgICBjaGVja2JveC5pZCA9ICd0b2RvLWNvbXBsZWF0ZSc7XG5cbiAgICAgICAgY2hlY2tib3guYWRkRXZlbnRMaXN0ZW5lcignY2hhbmdlJywgKGUpID0+IHtcbiAgICAgICAgICB0aGlzLm9uQ29tcGxlYXRlKGUpO1xuICAgICAgICB9KTtcblxuICAgICAgICAvLyB0b2RvIGRlc2NyaXB0aW9uXG4gICAgICAgIGNvbnN0IHRvZG9EZXMgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdwJyk7XG4gICAgICAgIHRvZG9EZXMuY2xhc3NOYW1lID0gJ3RvZG8tZGVzJztcbiAgICAgICAgdG9kb0Rlcy5pbm5lclRleHQgPSB0b2RvLmRlc2NyaXB0aW9uO1xuXG4gICAgICAgIGlmICh0b2RvLmNvbXBsZXRlZCkge1xuICAgICAgICAgIGNoZWNrYm94LnNldEF0dHJpYnV0ZSgnY2hlY2tlZCcsICd5ZXMnKTtcbiAgICAgICAgICB0b2RvRGVzLmNsYXNzTGlzdC5hZGQoJ3RvZG8tY29tcGxlYXRlZCcpO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gdG9kbyBUaHJlZSBkb3QgYnV0dG9uXG4gICAgICAgIGNvbnN0IHRocmVlRG90QnV0dG9uID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYnV0dG9uJyk7XG4gICAgICAgIHRocmVlRG90QnV0dG9uLmNsYXNzTmFtZSA9ICdidG4tdGhyZWUtZG90JztcbiAgICAgICAgdGhyZWVEb3RCdXR0b24uaW5uZXJIVE1MID0gYDxpbWcgc3JjPVwiJHt0aHJlZURvdEljb259XCIgYWx0PVwiLi4uXCI+YDtcblxuICAgICAgICAvLyBhZGQgZXZlbnQgb24gdGhyZWUgaWNvbiBmb3IgZWRpdCBhbmQgZGVsZXRlLlxuICAgICAgICB0aHJlZURvdEJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIChlKSA9PiB7XG4gICAgICAgICAgdGhpcy5vbkNsaWNrVG9kb0RlcyhlKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgLy8gQXBwZW5kIGFsbCB0aGUgdG9kbyBlbGVtZW50cyBpbnNpZGUgdGhlIHRvZG9JdGVtc1xuICAgICAgICB0b2RvSXRlbS5hcHBlbmQoY2hlY2tib3gsIHRvZG9EZXMsIHRocmVlRG90QnV0dG9uKTtcblxuICAgICAgICAvLyBhcHBlbnQgdGhlIHRvZG8gaXRlbSBpbnNpZGUgdG9kb0NvbnRhaW5lclxuICAgICAgICB0b2RvQ29udGFpbmVyLmFwcGVuZENoaWxkKHRvZG9JdGVtKTtcbiAgICAgIH0pO1xuICAgIH0gZWxzZSB7XG4gICAgICB0b2RvQ29udGFpbmVyLmlubmVySFRNTCA9ICc8cCBjbGFzcz1cIm5vLWl0ZW1cIj5UaGVyZSBpcyBubyB0b2RvIHRvIHNob3chIFBsZWFzZSBhZGQgYSBuZXcgb25lLjwvcD4nO1xuICAgIH1cbiAgfVxuXG4gIC8vIG9uU3VibWl0IG1ldGhvZFxuICBvblN1Ym1pdCA9ICgpID0+IHtcbiAgICAvLyBWYWxpZGF0ZSB0aGUgZm9ybVxuICAgIGNvbnN0IGRlc2NyaXB0aW9uID0gZm9ybUlucHV0LnZhbHVlO1xuICAgIGNvbnN0IHJlcXVpcmVkID0gdHJ1ZTtcbiAgICBjb25zdCBtaW5MZW5ndGggPSAzO1xuICAgIGNvbnN0IG1heExlbmd0aCA9IDI1NTtcbiAgICBjb25zdCBzcGVjaWFsQ2hhciA9IGZhbHNlO1xuICAgIGNvbnN0IGlzVmFsaWQgPSB2YWxpZGF0ZUZvcm0oZGVzY3JpcHRpb24sIHJlcXVpcmVkLCBtaW5MZW5ndGgsIG1heExlbmd0aCwgc3BlY2lhbENoYXIpO1xuXG4gICAgLy8gQ2hlY2sgaWYgZm9ybSBoYXMgZXJyb3Igb3Igbm90XG5cbiAgICBpZiAoaXNWYWxpZC5pc0Vycm9yID09PSB0cnVlICYmIGlzVmFsaWQubXNnLmxlbmd0aCA+PSAwKSB7XG4gICAgICBzaG93TXNnLmNsYXNzTGlzdC5hZGQoJ2Zvcm0tZXJyb3InKTtcbiAgICAgIHNob3dNc2cudGV4dENvbnRlbnQgPSBpc1ZhbGlkLm1zZztcbiAgICAgIGZvcm1JbnB1dC5jbGFzc0xpc3QuYWRkKCdpbnZhbGlkJyk7XG4gICAgfSBlbHNlIHtcbiAgICAgIC8vIGlmIGZvcm0gaXMgZW1wdHkgYWRkIGEgbmV3IHRvZG9cbiAgICAgIHNob3dNc2cuY2xhc3NMaXN0LnJlbW92ZSgnZm9ybS1lcnJvcicpO1xuICAgICAgc2hvd01zZy50ZXh0Q29udGVudCA9ICcnO1xuICAgICAgZm9ybUlucHV0LmNsYXNzTGlzdC5yZW1vdmUoJ2ludmFsaWQnKTtcbiAgICAgIGZvcm1JbnB1dC52YWx1ZSA9ICcnO1xuICAgICAgY29uc3QgaW5kZXggPSB0aGlzLnRvZG9zLmxlbmd0aCArIDEgfHwgMTtcbiAgICAgIGNvbnN0IHRvZG8gPSB7XG4gICAgICAgIGRlc2NyaXB0aW9uLFxuICAgICAgICBjb21wbGV0ZWQ6IGZhbHNlLFxuICAgICAgICBpbmRleCxcbiAgICAgIH07XG4gICAgICB0aGlzLnRvZG9zID0gWy4uLnRoaXMudG9kb3MsIHRvZG9dO1xuICAgICAgLy8gcmVuZGVyIHRoZSBuZXcgdG9kb3Mgb24gdGhlIGRvbVxuICAgICAgdGhpcy5yZW5kZXIoKTtcbiAgICB9XG4gIH1cblxuICBkZWxldGUgPSAoaW5kZXgpID0+IHtcbiAgICB0aGlzLnRvZG9zID0gdGhpcy50b2Rvcy5maWx0ZXIoKHQpID0+IHQuaW5kZXgudG9TdHJpbmcoKSAhPT0gaW5kZXgpO1xuICAgIHRoaXMucmVuZGVyKCk7XG4gIH1cblxuICAvLyBlZGl0IHRvZG9cbiAgZWRpdCA9IChlKSA9PiB7XG4gICAgY29uc3QgeyB2YWx1ZSB9ID0gZS50YXJnZXQ7XG5cbiAgICAvLyB2YWxpZGF0ZSBmb3JtXG4gICAgY29uc3QgcmVxdWlyZWQgPSB0cnVlO1xuICAgIGNvbnN0IG1pbkxlbmd0aCA9IDM7XG4gICAgY29uc3QgbWF4TGVuZ3RoID0gMjU1O1xuICAgIGNvbnN0IHNwZWNpYWxDaGFyID0gZmFsc2U7XG4gICAgY29uc3QgaXNWYWxpZCA9IHZhbGlkYXRlRm9ybSh2YWx1ZSwgcmVxdWlyZWQsIG1pbkxlbmd0aCwgbWF4TGVuZ3RoLCBzcGVjaWFsQ2hhcik7XG4gICAgaWYgKGlzVmFsaWQuaXNFcnJvciA9PT0gdHJ1ZSAmJiBpc1ZhbGlkLm1zZy5sZW5ndGggPiAwKSB7XG4gICAgICBzaG93TXNnLmNsYXNzTGlzdC5hZGQoJ2Zvcm0tZXJyb3InKTtcbiAgICAgIHNob3dNc2cudGV4dENvbnRlbnQgPSBpc1ZhbGlkLm1zZztcbiAgICAgIGUudGFyZ2V0LmNsYXNzTGlzdC5hZGQoJ2ludmFsaWQtZWRpdCcpO1xuICAgIH0gZWxzZSB7XG4gICAgICBlLnRhcmdldC5jbGFzc0xpc3QucmVtb3ZlKCdpbnZhbGlkLWVkaXQnKTtcbiAgICAgIGNvbnN0IGluZGV4ID0gZS50YXJnZXQucGFyZW50RWxlbWVudC5pZDtcbiAgICAgIGNvbnN0IG5ld0FyciA9IFsuLi50aGlzLnRvZG9zXTtcbiAgICAgIGNvbnN0IGluZHggPSBuZXdBcnIuZmluZEluZGV4KChpdGVtKSA9PiBpbmRleCA9PT0gaXRlbS5pbmRleC50b1N0cmluZygpKTtcbiAgICAgIGlmIChpbmR4ID49IDApIHtcbiAgICAgICAgbmV3QXJyW2luZHhdLmRlc2NyaXB0aW9uID0gdmFsdWU7XG4gICAgICB9XG4gICAgICB0aGlzLnRvZG9zID0gWy4uLm5ld0Fycl07XG4gICAgICB0aGlzLnJlbmRlcigpO1xuICAgIH1cbiAgfVxuXG4gIC8vIG9uQ2xpY2tEZXMgZW5lbnQgbWV0aG9kXG4gIG9uQ2xpY2tUb2RvRGVzID0gKGUpID0+IHtcbiAgICAvLyB0YXJnZXQub3V0ZXJIVE1MID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgndGV4dGFyZWEnKTtcbiAgICBjb25zdCBwYXJlbnQgPSBlLnRhcmdldC5wYXJlbnRFbGVtZW50LnBhcmVudEVsZW1lbnQ7XG4gICAgY29uc3QgZ2V0VG90b2RlcyA9IHBhcmVudC5xdWVyeVNlbGVjdG9yKCcudG9kby1kZXMnKS5pbm5lclRleHQ7XG4gICAgcGFyZW50LmlubmVySFRNTCA9ICcnO1xuXG4gICAgLy8gdG9kbyBjaGVja2JveFxuICAgIGNvbnN0IGNoZWNrYm94ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnaW5wdXQnKTtcbiAgICBjaGVja2JveC5zZXRBdHRyaWJ1dGUoJ3R5cGUnLCAnY2hlY2tib3gnKTtcbiAgICBjaGVja2JveC5pZCA9ICd0b2RvLWNvbXBsZWF0ZSc7XG5cbiAgICBjaGVja2JveC5hZGRFdmVudExpc3RlbmVyKCdjaGFuZ2UnLCAoZSkgPT4ge1xuICAgICAgdGhpcy5vbkNvbXBsZWF0ZShlKTtcbiAgICB9KTtcblxuICAgIC8vIHRvZG8gZGVzY3JpcHRpb25cbiAgICBjb25zdCB0b2RvRWRpdElucHV0ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnaW5wdXQnKTtcbiAgICB0b2RvRWRpdElucHV0LnNldEF0dHJpYnV0ZSgndHlwZScsICd0ZXh0Jyk7XG4gICAgdG9kb0VkaXRJbnB1dC5zZXRBdHRyaWJ1dGUoJ3ZhbHVlJywgZ2V0VG90b2Rlcyk7XG4gICAgdG9kb0VkaXRJbnB1dC5jbGFzc05hbWUgPSAndG9kby1lZGl0LWlucHV0JztcblxuICAgIC8vIEFkZCBldmVudCBvbiBrZXlwcmVzcyBpbiB0aGUgdGV4dGFyZWFcbiAgICB0b2RvRWRpdElucHV0LmFkZEV2ZW50TGlzdGVuZXIoJ2tleXByZXNzJywgKGUpID0+IHtcbiAgICAgIGlmIChlLmtleSA9PT0gJ0VudGVyJykge1xuICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgIHRoaXMuZWRpdChlKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHNob3dNc2cuY2xhc3NMaXN0LnJlbW92ZSgnZm9ybS1lcnJvcicpO1xuICAgICAgICBzaG93TXNnLmlubmVyVGV4dCA9ICcnO1xuICAgICAgICBlLnRhcmdldC5jbGFzc0xpc3QucmVtb3ZlKCdpbnZhbGlkLWVkaXQnKTtcbiAgICAgIH1cbiAgICB9KTtcblxuICAgIC8vIHRvZG8gRGVsZXRlIGRvdCBidXR0b25cbiAgICBjb25zdCBkZWxldGVUb2RvID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYnV0dG9uJyk7XG4gICAgZGVsZXRlVG9kby5jbGFzc05hbWUgPSAnYnRuLWRlbGV0ZSc7XG4gICAgZGVsZXRlVG9kby5pbm5lckhUTUwgPSBgPGltZyBzcmM9XCIke2RlbGV0ZUljb259XCIgYWx0PVwiWFwiPmA7XG5cbiAgICAvLyBhZGRpbmcgZXZlbnQgb24gZGVsZXRlIGljb25cbiAgICBkZWxldGVUb2RvLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4ge1xuICAgICAgY29uc3QgaW5kZXggPSBwYXJlbnQuaWQ7XG4gICAgICB0aGlzLmRlbGV0ZShpbmRleCk7XG4gICAgfSk7XG5cbiAgICBwYXJlbnQuYXBwZW5kKGNoZWNrYm94LCB0b2RvRWRpdElucHV0LCBkZWxldGVUb2RvKTtcbiAgfVxuXG4gIG9uQ29tcGxlYXRlID0gKGUpID0+IHtcbiAgICBjb25zdCBpbmRleCA9IGUudGFyZ2V0LnBhcmVudEVsZW1lbnQuaWQ7XG4gICAgY29uc3QgbmV3QXJyID0gWy4uLnRoaXMudG9kb3NdO1xuICAgIGNvbnN0IGluZHggPSBuZXdBcnIuZmluZEluZGV4KChpdGVtKSA9PiBpbmRleCA9PT0gaXRlbS5pbmRleC50b1N0cmluZygpKTtcbiAgICBpZiAoaW5keCA+PSAwKSB7XG4gICAgICBuZXdBcnJbaW5keF0uY29tcGxldGVkID0gIW5ld0FycltpbmR4XS5jb21wbGV0ZWQ7XG4gICAgfVxuICAgIHRoaXMudG9kb3MgPSBbLi4ubmV3QXJyXTtcbiAgICB0aGlzLnJlbmRlcigpO1xuICB9XG5cbiAgb25GaWx0ZXJDb21wbGV0ZWRUb2RvcyA9ICgpID0+IHtcbiAgICBsZXQgbmV3QXJyID0gWy4uLnRoaXMudG9kb3NdO1xuICAgIG5ld0FyciA9IG5ld0Fyci5maWx0ZXIoKGl0ZW0pID0+IGl0ZW0uY29tcGxldGVkICE9PSB0cnVlKTtcbiAgICB0aGlzLnRvZG9zID0gWy4uLm5ld0Fycl07XG4gICAgdGhpcy5yZW5kZXIoKTtcbiAgfVxufSIsImltcG9ydCAnLi9zdHlsZS5jc3MnO1xuaW1wb3J0IFRvZG9zIGZyb20gJy4vbW9kdWxlcy90b2Rvcy5qcyc7XG5pbXBvcnQge1xuICBmb3JtSW5wdXQsIGJ0blN1Ym1pdCwgc2hvd01zZywgZmlsdGVyQnV0dG9uLCB0b2RvQ29udGFpbmVyLFxufSBmcm9tICcuL21vZHVsZXMvZG9tU2VsZWN0b3IuanMnO1xuXG4vLyBJbXBvcnQgbmVjZXNzYXJ5IGFzc2V0cyBmb3JtIHNvdXJjZVxuaW1wb3J0IGVudGVySWNvbiBmcm9tICcuL2Fzc2V0cy9lbnRlci0yNC5wbmcnO1xuaW1wb3J0IHsgZ2V0QWZ0ZXJFbGVtZW50IH0gZnJvbSAnLi9tb2R1bGVzL3V0aWxzLmpzJztcblxuLy8gSW5pdGlhbGl6ZSB0aGUgdG9kb3NcbmNvbnN0IHRvZG9zID0gbmV3IFRvZG9zKCk7XG5cbi8vIHRvZG8gc3VibWl0IGV2ZW50IHVzaW5nIEVudGVyIGJ1dHRvbi5cbmZvcm1JbnB1dC5hZGRFdmVudExpc3RlbmVyKCdrZXlwcmVzcycsIChlKSA9PiB7XG4gIGlmIChlLmtleSA9PT0gJ0VudGVyJykge1xuICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICB0b2Rvcy5vblN1Ym1pdCgpO1xuICB9IGVsc2Uge1xuICAgIHNob3dNc2cuaW5uZXJIVE1MID0gJyc7XG4gICAgc2hvd01zZy5jbGFzc0xpc3QucmVtb3ZlKCdmb3JtLWVycm9yJyk7XG4gICAgZm9ybUlucHV0LmNsYXNzTGlzdC5yZW1vdmUoJ2ludmFsaWQnKTtcbiAgfVxufSk7XG5cbi8vIHRvZG8gc3VibWl0IGV2ZW50IHVzaW5nIHN1Ym1pdCBidXR0b25cbmJ0blN1Ym1pdC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIChlKSA9PiB7XG4gIGUucHJldmVudERlZmF1bHQoKTtcbiAgdG9kb3Mub25TdWJtaXQoKTtcbn0pO1xuXG4vLyBmaWx0ZXIgYWxsIGNvbXBsZXRlZCBsaXN0O1xuZmlsdGVyQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4ge1xuICB0b2Rvcy5vbkZpbHRlckNvbXBsZXRlZFRvZG9zKCk7XG59KTtcblxuLy8gZHJhZyBvdmVyIGVuZW50O1xudG9kb0NvbnRhaW5lci5hZGRFdmVudExpc3RlbmVyKCdkcmFnb3ZlcicsIChlKSA9PiB7XG4gIGUucHJldmVudERlZmF1bHQoKTtcbiAgY29uc3QgZ2V0QWZ0ZXJFbGVtZW50UG9zaXRpb24gPSBnZXRBZnRlckVsZW1lbnQodG9kb0NvbnRhaW5lciwgZS5jbGllbnRZKTtcbiAgY29uc3QgZHJhZ2dpbmcgPSB0b2RvQ29udGFpbmVyLnF1ZXJ5U2VsZWN0b3IoJy5kcmFnZ2luZycpO1xuXG4gIGlmIChkcmFnZ2luZyA9PSBudWxsKSB7XG4gICAgdG9kb0NvbnRhaW5lci5hcHBlbmRDaGlsZChkcmFnZ2luZyk7XG4gIH0gZWxzZSB7XG4gICAgdG9kb0NvbnRhaW5lci5pbnNlcnRCZWZvcmUoZHJhZ2dpbmcsIGdldEFmdGVyRWxlbWVudFBvc2l0aW9uKTtcbiAgfVxufSk7XG5cbi8vIExvYWQgdGhlIHRvZG8gbGlzdCBvbiB0aGUgZmx5Llxud2luZG93Lm9ubG9hZCA9ICgpID0+IHtcbiAgdG9kb3MucmVuZGVyKCk7XG4gIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5idG4tc3VibWl0JykuaW5uZXJIVE1MID0gYDxpbWcgc3JjPScke2VudGVySWNvbn0nIGFsdD0nc3VibWl0Jy8+YDtcbn07XG4iXSwibmFtZXMiOlsidmFsaWRhdGVGb3JtIiwic3RyIiwicmVxdWlyZWQiLCJtaW5MZW5ndGgiLCJtYXhMZW5ndGgiLCJzcGVjaWFsQ2hhciIsImlzRXJyb3IiLCJtc2ciLCJsZW4iLCJ0cmltIiwibGVuZ3RoIiwibmV3U3RyIiwicmVwbGFjZSIsInJlIiwidGVzdCIsImZvcm1JbnB1dCIsImRvY3VtZW50IiwiZ2V0RWxlbWVudEJ5SWQiLCJzaG93TXNnIiwicXVlcnlTZWxlY3RvciIsImJ0blN1Ym1pdCIsInRvZG9Db250YWluZXIiLCJmaWx0ZXJCdXR0b24iLCJxdWVyeVNlbGVjdG9yQWxsIiwiVG9kb3MiLCJ0b2RvQXJyIiwidG9kb3MiLCJzb3J0IiwiYSIsImIiLCJpbmRleCIsImZvckVhY2giLCJ0b2RvIiwibG9jYWxTdG9yYWdlIiwic2V0SXRlbSIsIkpTT04iLCJzdHJpbmdpZnkiLCJpbm5lckhUTUwiLCJpbm5lclRleHQiLCJjbGFzc0xpc3QiLCJyZW1vdmUiLCJzb3J0QW5kU2F2ZSIsInRvZG9JdGVtIiwiY3JlYXRlRWxlbWVudCIsImlkIiwiY2xhc3NOYW1lIiwic2V0QXR0cmlidXRlIiwiYWRkRXZlbnRMaXN0ZW5lciIsImFkZCIsImNoZWNrYm94IiwiZSIsIm9uQ29tcGxlYXRlIiwidG9kb0RlcyIsImRlc2NyaXB0aW9uIiwiY29tcGxldGVkIiwidGhyZWVEb3RCdXR0b24iLCJ0aHJlZURvdEljb24iLCJvbkNsaWNrVG9kb0RlcyIsImFwcGVuZCIsImFwcGVuZENoaWxkIiwidmFsdWUiLCJpc1ZhbGlkIiwidGV4dENvbnRlbnQiLCJyZW5kZXIiLCJmaWx0ZXIiLCJ0IiwidG9TdHJpbmciLCJ0YXJnZXQiLCJwYXJlbnRFbGVtZW50IiwibmV3QXJyIiwiaW5keCIsImZpbmRJbmRleCIsIml0ZW0iLCJwYXJlbnQiLCJnZXRUb3RvZGVzIiwidG9kb0VkaXRJbnB1dCIsImtleSIsInByZXZlbnREZWZhdWx0IiwiZWRpdCIsImRlbGV0ZVRvZG8iLCJkZWxldGVJY29uIiwiZ2V0SXRlbSIsInRoaXMiLCJwYXJzZSIsIm9uU3VibWl0Iiwib25GaWx0ZXJDb21wbGV0ZWRUb2RvcyIsImdldEFmdGVyRWxlbWVudFBvc2l0aW9uIiwieSIsInJlZHVjZSIsIm5lYXJlc3QiLCJib3giLCJnZXRCb3VuZGluZ0NsaWVudFJlY3QiLCJvZmZzZXQiLCJ0b3AiLCJoZWlnaHQiLCJlbGVtZW50IiwiTnVtYmVyIiwiTkVHQVRJVkVfSU5GSU5JVFkiLCJnZXRBZnRlckVsZW1lbnQiLCJjbGllbnRZIiwiZHJhZ2dpbmciLCJpbnNlcnRCZWZvcmUiLCJ3aW5kb3ciLCJvbmxvYWQiLCJlbnRlckljb24iXSwic291cmNlUm9vdCI6IiJ9