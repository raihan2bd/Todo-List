"use strict";(self.webpackChunktodo_list=self.webpackChunktodo_list||[]).push([[826],{852:(e,t,r)=>{function n(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var o=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,o=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],i=!1,a="",s=(e=e.trim()).length;if(t&&e.length<=0)return{isError:i=!0,msg:a="This field is Required!"};if(r>0&&s<r)return{isError:i=!0,msg:a="The min character length of this field is ".concat(r)};if(n>0&&s>n)return{isError:i=!0,msg:a="The max character length of this field is ".concat(n)};if(!o){var c=e.replace(/\s/g,""),d=/^[A-Za-z][A-Za-z0-9-_.]*$/;if(!d.test(c))return{isError:i=!0,msg:a="This field is only allow A-z0-9_.- characters and also first character should be A-z"}}return{isError:i,msg:a}},i=document.getElementById("description"),a=document.querySelector(".show-msg"),s=document.querySelector(".btn-submit"),c=document.querySelector(".todo-items-gropu"),d=(document.querySelectorAll(".todo-des"),document.querySelector(".btn-clear-all"));const l=r.p+"images/three-dot-24.png",u=r.p+"images/trash-24.png";function f(e){return f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},f(e)}function m(e){return function(e){if(Array.isArray(e))return p(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return p(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?p(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function p(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function v(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,h(n.key),n)}}function g(e,t,r){return t&&v(e.prototype,t),r&&v(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function y(e,t,r){return(t=h(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function h(e){var t=function(e,t){if("object"!==f(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,"string");if("object"!==f(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===f(t)?t:String(t)}var b=g((function e(){var t=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),y(this,"sortAndSave",(function(){var e=m(t.todos);e.sort((function(e,t){return e.index>t.index?1:e.index<t.index?-1:0}));var r=0;e.forEach((function(e){r+=1,e.index=r})),t.todos=m(e),localStorage.setItem("todos",JSON.stringify(t.todos))})),y(this,"render",(function(){c.innerHTML="",a.innerText="",a.classList.remove("form-error"),t.sortAndSave(),t.todos.length>0?t.todos.forEach((function(e){var r=document.createElement("li");r.id=e.index,r.className="todo-item",r.setAttribute("draggable",!0),r.addEventListener("dragstart",(function(){r.classList.add("dragging")})),r.addEventListener("dragend",(function(){r.classList.remove("dragging");var e=c.querySelectorAll(".todo-item"),n=[];e.forEach((function(e){var r=e.getAttribute("id"),o=t.todos.find((function(e){return e.index===+r}));o&&n.push(o)}));var o=0;n.forEach((function(e){o+=1,e.index=o})),t.todos=n,t.render()}));var n=document.createElement("input");n.setAttribute("type","checkbox"),n.id="todo-compleate",n.addEventListener("change",(function(e){t.onCompleate(e)}));var o=document.createElement("p");o.className="todo-des",o.innerText=e.description,e.completed&&(n.setAttribute("checked","yes"),o.classList.add("todo-compleated"));var i=document.createElement("button");i.className="btn-three-dot",i.innerHTML='<img src="'.concat(l,'" alt="...">'),i.addEventListener("click",(function(e){t.onClickTodoDes(e)})),r.append(n,o,i),c.appendChild(r)})):c.innerHTML='<p class="no-item">There is no todo to show! Please add a new one.</p>'})),y(this,"onSubmit",(function(){var e=i.value,r=o(e,!0,3,255,!1);if(!0===r.isError&&r.msg.length>=0)a.classList.add("form-error"),a.textContent=r.msg,i.classList.add("invalid");else{a.classList.remove("form-error"),a.textContent="",i.classList.remove("invalid"),i.value="";var n={description:e,completed:!1,index:t.todos.length+1||1};t.todos=[].concat(m(t.todos),[n]),t.render()}})),y(this,"delete",(function(e){t.todos=t.todos.filter((function(t){return t.index.toString()!==e})),t.render()})),y(this,"edit",(function(e){var r=e.target.value,n=o(r,!0,3,255,!1);if(!0===n.isError&&n.msg.length>0)a.classList.add("form-error"),a.textContent=n.msg,e.target.classList.add("invalid-edit");else{e.target.classList.remove("invalid-edit");var i=e.target.parentElement.id,s=m(t.todos),c=s.findIndex((function(e){return i===e.index.toString()}));c>=0&&(s[c].description=r),t.todos=m(s),t.render()}})),y(this,"onClickTodoDes",(function(e){var r=e.target.parentElement.parentElement,n=r.querySelector(".todo-des").innerText;r.innerHTML="";var o=document.createElement("input");o.setAttribute("type","checkbox"),o.id="todo-compleate",o.addEventListener("change",(function(e){t.onCompleate(e)}));var i=document.createElement("input");i.setAttribute("type","text"),i.setAttribute("value",n),i.className="todo-edit-input",i.addEventListener("keypress",(function(e){"Enter"===e.key?(e.preventDefault(),t.edit(e)):(a.classList.remove("form-error"),a.innerText="",e.target.classList.remove("invalid-edit"))}));var s=document.createElement("button");s.className="btn-delete",s.innerHTML='<img src="'.concat(u,'" alt="X">'),s.addEventListener("click",(function(){var e=r.id;t.delete(e)})),r.append(o,i,s)})),y(this,"onCompleate",(function(e){var r=e.target.parentElement.id,n=m(t.todos),o=n.findIndex((function(e){return r===e.index.toString()}));o>=0&&(n[o].completed=!n[o].completed),t.todos=m(n),t.render()})),y(this,"onFilterCompletedTodos",(function(){var e=m(t.todos);e=e.filter((function(e){return!0!==e.completed})),t.todos=m(e),t.render()})),localStorage.getItem("todos")?this.todos=JSON.parse(localStorage.getItem("todos")):this.todos=[]}));const E=r.p+"images/enter-24.png";var S=new b;i.addEventListener("keypress",(function(e){"Enter"===e.key?(e.preventDefault(),S.onSubmit()):(a.innerHTML="",a.classList.remove("form-error"),i.classList.remove("invalid"))})),s.addEventListener("click",(function(e){e.preventDefault(),S.onSubmit()})),d.addEventListener("click",(function(){S.onFilterCompletedTodos()})),c.addEventListener("dragover",(function(e){e.preventDefault();var t=function(e,t){return(r=e.querySelectorAll(".todo-item:not(.dragging)"),function(e){if(Array.isArray(e))return n(e)}(r)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(r)||function(e,t){if(e){if("string"==typeof e)return n(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?n(e,t):void 0}}(r)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()).reduce((function(e,r){var n=r.getBoundingClientRect(),o=t-n.top-n.height/2;return o<0&&o>e.offset?{offset:o,element:r}:e}),{offset:Number.NEGATIVE_INFINITY}).element;var r}(c,e.clientY),r=c.querySelector(".dragging");null==r?c.appendChild(r):c.insertBefore(r,t)})),window.onload=function(){S.render(),document.querySelector(".btn-submit").innerHTML="<img src='".concat(E,"' alt='submit'/>")}}},e=>{e(e.s=852)}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaW5kZXguYnVuZGxlLmpzIiwibWFwcGluZ3MiOiI4TUFBTyxJQUFNQSxFQUFlLFNBQzFCQyxHQUNHLElBREVDLEVBQVcsVUFBSCw4Q0FBVUMsRUFBWSxVQUFILDZDQUFHLEVBQUdDLEVBQVksVUFBSCw2Q0FBRyxFQUFHQyxJQUFjLFVBQUgsK0NBRTVEQyxHQUFVLEVBQ1ZDLEVBQU0sR0FFSkMsR0FETlAsRUFBTUEsRUFBSVEsUUFDTUMsT0FFaEIsR0FBSVIsR0FDRUQsRUFBSVMsUUFBVSxFQUdoQixNQUFPLENBQUVKLFFBRlRBLEdBQVUsRUFFUUMsSUFEbEJBLEVBQU0sMkJBS1YsR0FBSUosRUFBWSxHQUNWSyxFQUFNTCxFQUdSLE1BQU8sQ0FBRUcsUUFGVEEsR0FBVSxFQUVRQyxJQURsQkEsRUFBTSw2Q0FBSCxPQUFnREosSUFLdkQsR0FBSUMsRUFBWSxHQUNWSSxFQUFNSixFQUdSLE1BQU8sQ0FBRUUsUUFGVEEsR0FBVSxFQUVRQyxJQURsQkEsRUFBTSw2Q0FBSCxPQUFnREgsSUFLdkQsSUFBS0MsRUFBYSxDQUNoQixJQUFNTSxFQUFTVixFQUFJVyxRQUFRLE1BQU8sSUFDNUJDLEVBQUssNEJBQ1gsSUFBS0EsRUFBR0MsS0FBS0gsR0FHWCxNQUFPLENBQUVMLFFBRlRBLEdBQVUsRUFFUUMsSUFEbEJBLEVBQU0sdUZBR1YsQ0FDQSxNQUFPLENBQUVELFFBQUFBLEVBQVNDLElBQUFBLEVBQ3BCLEVDMUNhUSxFQUFZQyxTQUFTQyxlQUFlLGVBQ3BDQyxFQUFVRixTQUFTRyxjQUFjLGFBQ2pDQyxFQUFZSixTQUFTRyxjQUFjLGVBQ25DRSxFQUFnQkwsU0FBU0csY0FBYyxxQkFFdkNHLEdBRGVOLFNBQVNPLGlCQUFpQixhQUMxQlAsU0FBU0csY0FBYyxtQiw2c0RDQUgsSUFFM0JLLEVBQUssR0FDeEIsYUFBYyxZLDRGQUFBLCtCQVFBLFdBQ1osSUFBTUMsRUFBVSxFQUFJLEVBQUtDLE9BRXpCRCxFQUFRRSxNQUFLLFNBQUNDLEVBQUdDLEdBQ2YsT0FBSUQsRUFBRUUsTUFBUUQsRUFBRUMsTUFDUCxFQUVMRixFQUFFRSxNQUFRRCxFQUFFQyxPQUNOLEVBRUgsQ0FDVCxJQUdBLElBQUlBLEVBQVEsRUFDWkwsRUFBUU0sU0FBUSxTQUFDQyxHQUNmRixHQUFTLEVBQ1RFLEVBQUtGLE1BQVFBLENBQ2YsSUFFQSxFQUFLSixNQUFRLEVBQUlELEdBQ2pCUSxhQUFhQyxRQUFRLFFBQVNDLEtBQUtDLFVBQVUsRUFBS1YsT0FDcEQsSUFBQyxpQkFHUSxXQUNQTCxFQUFjZ0IsVUFBWSxHQUMxQm5CLEVBQVFvQixVQUFZLEdBQ3BCcEIsRUFBUXFCLFVBQVVDLE9BQU8sY0FDekIsRUFBS0MsY0FDRCxFQUFLZixNQUFNaEIsT0FBUyxFQUN0QixFQUFLZ0IsTUFBTUssU0FBUSxTQUFDQyxHQUVsQixJQUFNVSxFQUFXMUIsU0FBUzJCLGNBQWMsTUFDeENELEVBQVNFLEdBQUtaLEVBQUtGLE1BQ25CWSxFQUFTRyxVQUFZLFlBQ3JCSCxFQUFTSSxhQUFhLGFBQWEsR0FHbkNKLEVBQVNLLGlCQUFpQixhQUFhLFdBQ3JDTCxFQUFTSCxVQUFVUyxJQUFJLFdBQ3pCLElBRUFOLEVBQVNLLGlCQUFpQixXQUFXLFdBQ25DTCxFQUFTSCxVQUFVQyxPQUFPLFlBQzFCLElBQU1TLEVBQXFCNUIsRUFBY0UsaUJBQWlCLGNBQ3BEMkIsRUFBVyxHQUNqQkQsRUFBbUJsQixTQUFRLFNBQUNvQixHQUMxQixJQUFNUCxFQUFLTyxFQUFLQyxhQUFhLE1BQ3ZCQyxFQUFXLEVBQUszQixNQUFNNEIsTUFBSyxTQUFDQyxHQUFDLE9BQUtBLEVBQUV6QixTQUFXYyxDQUFFLElBQ25EUyxHQUNGSCxFQUFTTSxLQUFLSCxFQUVsQixJQUVBLElBQUl2QixFQUFRLEVBQ1pvQixFQUFTbkIsU0FBUSxTQUFDQyxHQUNoQkYsR0FBUyxFQUNURSxFQUFLRixNQUFRQSxDQUNmLElBQ0EsRUFBS0osTUFBUXdCLEVBQ2IsRUFBS08sUUFDUCxJQUdBLElBQU1DLEVBQVcxQyxTQUFTMkIsY0FBYyxTQUN4Q2UsRUFBU1osYUFBYSxPQUFRLFlBQzlCWSxFQUFTZCxHQUFLLGlCQUVkYyxFQUFTWCxpQkFBaUIsVUFBVSxTQUFDWSxHQUNuQyxFQUFLQyxZQUFZRCxFQUNuQixJQUdBLElBQU1FLEVBQVU3QyxTQUFTMkIsY0FBYyxLQUN2Q2tCLEVBQVFoQixVQUFZLFdBQ3BCZ0IsRUFBUXZCLFVBQVlOLEVBQUs4QixZQUVyQjlCLEVBQUsrQixZQUNQTCxFQUFTWixhQUFhLFVBQVcsT0FDakNlLEVBQVF0QixVQUFVUyxJQUFJLG9CQUl4QixJQUFNZ0IsRUFBaUJoRCxTQUFTMkIsY0FBYyxVQUM5Q3FCLEVBQWVuQixVQUFZLGdCQUMzQm1CLEVBQWUzQixVQUFZLGFBQUgsT0FBZ0I0QixFQUFZLGdCQUdwREQsRUFBZWpCLGlCQUFpQixTQUFTLFNBQUNZLEdBQ3hDLEVBQUtPLGVBQWVQLEVBQ3RCLElBR0FqQixFQUFTeUIsT0FBT1QsRUFBVUcsRUFBU0csR0FHbkMzQyxFQUFjK0MsWUFBWTFCLEVBQzVCLElBRUFyQixFQUFjZ0IsVUFBWSx3RUFFOUIsSUFBQyxtQkFHVSxXQUVULElBQU15QixFQUFjL0MsRUFBVXNELE1BS3hCQyxFQUFVdEUsRUFDZDhELEdBTGUsRUFDQyxFQUNBLEtBQ0UsR0FXcEIsSUFBd0IsSUFBcEJRLEVBQVFoRSxTQUFvQmdFLEVBQVEvRCxJQUFJRyxRQUFVLEVBQ3BEUSxFQUFRcUIsVUFBVVMsSUFBSSxjQUN0QjlCLEVBQVFxRCxZQUFjRCxFQUFRL0QsSUFDOUJRLEVBQVV3QixVQUFVUyxJQUFJLGVBQ25CLENBRUw5QixFQUFRcUIsVUFBVUMsT0FBTyxjQUN6QnRCLEVBQVFxRCxZQUFjLEdBQ3RCeEQsRUFBVXdCLFVBQVVDLE9BQU8sV0FDM0J6QixFQUFVc0QsTUFBUSxHQUNsQixJQUNNckMsRUFBTyxDQUNYOEIsWUFBQUEsRUFDQUMsV0FBVyxFQUNYakMsTUFKWSxFQUFLSixNQUFNaEIsT0FBUyxHQUFLLEdBTXZDLEVBQUtnQixNQUFRLEdBQUgsU0FBTyxFQUFLQSxPQUFLLENBQUVNLElBRTdCLEVBQUt5QixRQUNQLENBQ0YsSUFBQyxpQkFFUSxTQUFDM0IsR0FDUixFQUFLSixNQUFRLEVBQUtBLE1BQU04QyxRQUFPLFNBQUNqQixHQUFDLE9BQUtBLEVBQUV6QixNQUFNMkMsYUFBZTNDLENBQUssSUFDbEUsRUFBSzJCLFFBQ1AsSUFBQyxlQUdNLFNBQUNFLEdBQ04sSUFBUVUsRUFBVVYsRUFBRWUsT0FBWkwsTUFPRkMsRUFBVXRFLEVBQ2RxRSxHQUxlLEVBQ0MsRUFDQSxLQUNFLEdBUXBCLElBQXdCLElBQXBCQyxFQUFRaEUsU0FBb0JnRSxFQUFRL0QsSUFBSUcsT0FBUyxFQUNuRFEsRUFBUXFCLFVBQVVTLElBQUksY0FDdEI5QixFQUFRcUQsWUFBY0QsRUFBUS9ELElBQzlCb0QsRUFBRWUsT0FBT25DLFVBQVVTLElBQUksb0JBQ2xCLENBQ0xXLEVBQUVlLE9BQU9uQyxVQUFVQyxPQUFPLGdCQUMxQixJQUFNVixFQUFRNkIsRUFBRWUsT0FBT0MsY0FBYy9CLEdBQy9CZ0MsRUFBUyxFQUFJLEVBQUtsRCxPQUNsQm1ELEVBQU9ELEVBQU9FLFdBQVUsU0FBQzNCLEdBQUksT0FBS3JCLElBQVVxQixFQUFLckIsTUFBTTJDLFVBQVUsSUFDbkVJLEdBQVEsSUFDVkQsRUFBT0MsR0FBTWYsWUFBY08sR0FFN0IsRUFBSzNDLE1BQVEsRUFBSWtELEdBQ2pCLEVBQUtuQixRQUNQLENBQ0YsSUFBQyx5QkFHZ0IsU0FBQ0UsR0FFaEIsSUFBTW9CLEVBQVNwQixFQUFFZSxPQUFPQyxjQUFjQSxjQUNoQ0ssRUFBYUQsRUFBTzVELGNBQWMsYUFBYW1CLFVBQ3JEeUMsRUFBTzFDLFVBQVksR0FHbkIsSUFBTXFCLEVBQVcxQyxTQUFTMkIsY0FBYyxTQUN4Q2UsRUFBU1osYUFBYSxPQUFRLFlBQzlCWSxFQUFTZCxHQUFLLGlCQUVkYyxFQUFTWCxpQkFBaUIsVUFBVSxTQUFDWSxHQUNuQyxFQUFLQyxZQUFZRCxFQUNuQixJQUdBLElBQU1zQixFQUFnQmpFLFNBQVMyQixjQUFjLFNBQzdDc0MsRUFBY25DLGFBQWEsT0FBUSxRQUNuQ21DLEVBQWNuQyxhQUFhLFFBQVNrQyxHQUNwQ0MsRUFBY3BDLFVBQVksa0JBRzFCb0MsRUFBY2xDLGlCQUFpQixZQUFZLFNBQUNZLEdBQzVCLFVBQVZBLEVBQUV1QixLQUNKdkIsRUFBRXdCLGlCQUNGLEVBQUtDLEtBQUt6QixLQUVWekMsRUFBUXFCLFVBQVVDLE9BQU8sY0FDekJ0QixFQUFRb0IsVUFBWSxHQUNwQnFCLEVBQUVlLE9BQU9uQyxVQUFVQyxPQUFPLGdCQUU5QixJQUdBLElBQU02QyxFQUFhckUsU0FBUzJCLGNBQWMsVUFDMUMwQyxFQUFXeEMsVUFBWSxhQUN2QndDLEVBQVdoRCxVQUFZLGFBQUgsT0FBZ0JpRCxFQUFVLGNBRzlDRCxFQUFXdEMsaUJBQWlCLFNBQVMsV0FDbkMsSUFBTWpCLEVBQVFpRCxFQUFPbkMsR0FDckIsRUFBSSxPQUFRZCxFQUNkLElBRUFpRCxFQUFPWixPQUFPVCxFQUFVdUIsRUFBZUksRUFDekMsSUFBQyxzQkFFYSxTQUFDMUIsR0FDYixJQUFNN0IsRUFBUTZCLEVBQUVlLE9BQU9DLGNBQWMvQixHQUMvQmdDLEVBQVMsRUFBSSxFQUFLbEQsT0FDbEJtRCxFQUFPRCxFQUFPRSxXQUFVLFNBQUMzQixHQUFJLE9BQUtyQixJQUFVcUIsRUFBS3JCLE1BQU0yQyxVQUFVLElBQ25FSSxHQUFRLElBQ1ZELEVBQU9DLEdBQU1kLFdBQWFhLEVBQU9DLEdBQU1kLFdBRXpDLEVBQUtyQyxNQUFRLEVBQUlrRCxHQUNqQixFQUFLbkIsUUFDUCxJQUFDLGlDQUV3QixXQUN2QixJQUFJbUIsRUFBUyxFQUFJLEVBQUtsRCxPQUN0QmtELEVBQVNBLEVBQU9KLFFBQU8sU0FBQ3JCLEdBQUksT0FBd0IsSUFBbkJBLEVBQUtZLFNBQWtCLElBQ3hELEVBQUtyQyxNQUFRLEVBQUlrRCxHQUNqQixFQUFLbkIsUUFDUCxJQTdQTXhCLGFBQWFzRCxRQUFRLFNBQ3ZCQyxLQUFLOUQsTUFBUVMsS0FBS3NELE1BQU14RCxhQUFhc0QsUUFBUSxVQUU3Q0MsS0FBSzlELE1BQVEsRUFFakIsSSxrQ0NDRixJQUFNQSxFQUFRLElBQUlGLEVBR2xCVCxFQUFVZ0MsaUJBQWlCLFlBQVksU0FBQ1ksR0FDeEIsVUFBVkEsRUFBRXVCLEtBQ0p2QixFQUFFd0IsaUJBQ0Z6RCxFQUFNZ0UsYUFFTnhFLEVBQVFtQixVQUFZLEdBQ3BCbkIsRUFBUXFCLFVBQVVDLE9BQU8sY0FDekJ6QixFQUFVd0IsVUFBVUMsT0FBTyxXQUUvQixJQUdBcEIsRUFBVTJCLGlCQUFpQixTQUFTLFNBQUNZLEdBQ25DQSxFQUFFd0IsaUJBQ0Z6RCxFQUFNZ0UsVUFDUixJQUdBcEUsRUFBYXlCLGlCQUFpQixTQUFTLFdBQ3JDckIsRUFBTWlFLHdCQUNSLElBR0F0RSxFQUFjMEIsaUJBQWlCLFlBQVksU0FBQ1ksR0FDMUNBLEVBQUV3QixpQkFDRixJQUFNUyxFSEN1QixTQUFDdkUsRUFBZXdFLEdBRzdDLE8sRUFGK0J4RSxFQUFjRSxpQkFBaUIsNkIsa25CQUVwQ3VFLFFBQU8sU0FBQ0MsRUFBUzVDLEdBRXpDLElBQU02QyxFQUFNN0MsRUFBSzhDLHdCQUdYQyxFQUFTTCxFQUFJRyxFQUFJRyxJQUFNSCxFQUFJSSxPQUFTLEVBQzFDLE9BQUlGLEVBQVMsR0FBS0EsRUFBU0gsRUFBUUcsT0FDMUIsQ0FBRUEsT0FBQUEsRUFBUUcsUUFBU2xELEdBRXJCNEMsQ0FDVCxHQUFHLENBQUVHLE9BQVFJLE9BQU9DLG9CQUFxQkYsUSxLQUMzQyxDR2ZrQ0csQ0FBZ0JuRixFQUFlc0MsRUFBRThDLFNBQzNEQyxFQUFXckYsRUFBY0YsY0FBYyxhQUU3QixNQUFadUYsRUFDRnJGLEVBQWMrQyxZQUFZc0MsR0FFMUJyRixFQUFjc0YsYUFBYUQsRUFBVWQsRUFFekMsSUFHQWdCLE9BQU9DLE9BQVMsV0FDZG5GLEVBQU0rQixTQUNOekMsU0FBU0csY0FDUCxlQUNBa0IsVUFBWSxhQUFILE9BQWdCeUUsRUFBUyxtQkFDdEMsQyIsInNvdXJjZXMiOlsid2VicGFjazovL3RvZG8tbGlzdC8uL3NyYy9tb2R1bGVzL3V0aWxzLmpzIiwid2VicGFjazovL3RvZG8tbGlzdC8uL3NyYy9tb2R1bGVzL2RvbVNlbGVjdG9yLmpzIiwid2VicGFjazovL3RvZG8tbGlzdC8uL3NyYy9tb2R1bGVzL3RvZG9zLmpzIiwid2VicGFjazovL3RvZG8tbGlzdC8uL3NyYy9pbmRleC5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJleHBvcnQgY29uc3QgdmFsaWRhdGVGb3JtID0gKFxuICBzdHIsIHJlcXVpcmVkID0gZmFsc2UsIG1pbkxlbmd0aCA9IDAsIG1heExlbmd0aCA9IDAsIHNwZWNpYWxDaGFyID0gdHJ1ZSxcbikgPT4ge1xuICBsZXQgaXNFcnJvciA9IGZhbHNlO1xuICBsZXQgbXNnID0gJyc7XG4gIHN0ciA9IHN0ci50cmltKCk7XG4gIGNvbnN0IGxlbiA9IHN0ci5sZW5ndGg7XG5cbiAgaWYgKHJlcXVpcmVkKSB7XG4gICAgaWYgKHN0ci5sZW5ndGggPD0gMCkge1xuICAgICAgaXNFcnJvciA9IHRydWU7XG4gICAgICBtc2cgPSAnVGhpcyBmaWVsZCBpcyBSZXF1aXJlZCEnO1xuICAgICAgcmV0dXJuIHsgaXNFcnJvciwgbXNnIH07XG4gICAgfVxuICB9XG5cbiAgaWYgKG1pbkxlbmd0aCA+IDApIHtcbiAgICBpZiAobGVuIDwgbWluTGVuZ3RoKSB7XG4gICAgICBpc0Vycm9yID0gdHJ1ZTtcbiAgICAgIG1zZyA9IGBUaGUgbWluIGNoYXJhY3RlciBsZW5ndGggb2YgdGhpcyBmaWVsZCBpcyAke21pbkxlbmd0aH1gO1xuICAgICAgcmV0dXJuIHsgaXNFcnJvciwgbXNnIH07XG4gICAgfVxuICB9XG5cbiAgaWYgKG1heExlbmd0aCA+IDApIHtcbiAgICBpZiAobGVuID4gbWF4TGVuZ3RoKSB7XG4gICAgICBpc0Vycm9yID0gdHJ1ZTtcbiAgICAgIG1zZyA9IGBUaGUgbWF4IGNoYXJhY3RlciBsZW5ndGggb2YgdGhpcyBmaWVsZCBpcyAke21heExlbmd0aH1gO1xuICAgICAgcmV0dXJuIHsgaXNFcnJvciwgbXNnIH07XG4gICAgfVxuICB9XG5cbiAgaWYgKCFzcGVjaWFsQ2hhcikge1xuICAgIGNvbnN0IG5ld1N0ciA9IHN0ci5yZXBsYWNlKC9cXHMvZywgJycpO1xuICAgIGNvbnN0IHJlID0gL15bQS1aYS16XVtBLVphLXowLTktXy5dKiQvO1xuICAgIGlmICghcmUudGVzdChuZXdTdHIpKSB7XG4gICAgICBpc0Vycm9yID0gdHJ1ZTtcbiAgICAgIG1zZyA9ICdUaGlzIGZpZWxkIGlzIG9ubHkgYWxsb3cgQS16MC05Xy4tIGNoYXJhY3RlcnMgYW5kIGFsc28gZmlyc3QgY2hhcmFjdGVyIHNob3VsZCBiZSBBLXonO1xuICAgICAgcmV0dXJuIHsgaXNFcnJvciwgbXNnIH07XG4gICAgfVxuICB9XG4gIHJldHVybiB7IGlzRXJyb3IsIG1zZyB9O1xufTtcblxuZXhwb3J0IGNvbnN0IGdldEFmdGVyRWxlbWVudCA9ICh0b2RvQ29udGFpbmVyLCB5KSA9PiB7XG4gIGNvbnN0IGRyYWdGaWx0ZXJFbGVtZW50cyA9IFsuLi50b2RvQ29udGFpbmVyLnF1ZXJ5U2VsZWN0b3JBbGwoJy50b2RvLWl0ZW06bm90KC5kcmFnZ2luZyknKV07XG5cbiAgcmV0dXJuIGRyYWdGaWx0ZXJFbGVtZW50cy5yZWR1Y2UoKG5lYXJlc3QsIGl0ZW0pID0+IHtcbiAgICAvLyBnZXQgdGhlIGJveCBjb250ZW50XG4gICAgY29uc3QgYm94ID0gaXRlbS5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtcblxuICAgIC8vIGNhbGN1bGF0ZSB0aGUgb2Zmc2V0XG4gICAgY29uc3Qgb2Zmc2V0ID0geSAtIGJveC50b3AgLSBib3guaGVpZ2h0IC8gMjtcbiAgICBpZiAob2Zmc2V0IDwgMCAmJiBvZmZzZXQgPiBuZWFyZXN0Lm9mZnNldCkge1xuICAgICAgcmV0dXJuIHsgb2Zmc2V0LCBlbGVtZW50OiBpdGVtIH07XG4gICAgfVxuICAgIHJldHVybiBuZWFyZXN0O1xuICB9LCB7IG9mZnNldDogTnVtYmVyLk5FR0FUSVZFX0lORklOSVRZIH0pLmVsZW1lbnQ7XG59OyIsImV4cG9ydCBjb25zdCBmb3JtSW5wdXQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZGVzY3JpcHRpb24nKTtcbmV4cG9ydCBjb25zdCBzaG93TXNnID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnNob3ctbXNnJyk7XG5leHBvcnQgY29uc3QgYnRuU3VibWl0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmJ0bi1zdWJtaXQnKTtcbmV4cG9ydCBjb25zdCB0b2RvQ29udGFpbmVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnRvZG8taXRlbXMtZ3JvcHUnKTtcbmV4cG9ydCBjb25zdCB0b2RvSXRlbXNEZXMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcudG9kby1kZXMnKTtcbmV4cG9ydCBjb25zdCBmaWx0ZXJCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuYnRuLWNsZWFyLWFsbCcpOyIsImltcG9ydCB7IHZhbGlkYXRlRm9ybSB9IGZyb20gJy4vdXRpbHMuanMnO1xuaW1wb3J0IHsgdG9kb0NvbnRhaW5lciwgZm9ybUlucHV0LCBzaG93TXNnIH0gZnJvbSAnLi9kb21TZWxlY3Rvci5qcyc7XG5cbi8vIEltcG9ydCBuZWNlc3NhcnkgYXNzZXRzIGZvcm0gc291cmNlXG5pbXBvcnQgdGhyZWVEb3RJY29uIGZyb20gJy4uL2Fzc2V0cy90aHJlZS1kb3QtMjQucG5nJztcbmltcG9ydCBkZWxldGVJY29uIGZyb20gJy4uL2Fzc2V0cy90cmFzaC0yNC5wbmcnO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBUb2RvcyB7XG4gIGNvbnN0cnVjdG9yKCkge1xuICAgIGlmIChsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgndG9kb3MnKSkge1xuICAgICAgdGhpcy50b2RvcyA9IEpTT04ucGFyc2UobG9jYWxTdG9yYWdlLmdldEl0ZW0oJ3RvZG9zJykpO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLnRvZG9zID0gW107XG4gICAgfVxuICB9XG5cbiAgc29ydEFuZFNhdmUgPSAoKSA9PiB7XG4gICAgY29uc3QgdG9kb0FyciA9IFsuLi50aGlzLnRvZG9zXTtcbiAgICAvLyBzb3J0aW5nIHRoZSBsaXN0XG4gICAgdG9kb0Fyci5zb3J0KChhLCBiKSA9PiB7XG4gICAgICBpZiAoYS5pbmRleCA+IGIuaW5kZXgpIHtcbiAgICAgICAgcmV0dXJuIDE7XG4gICAgICB9XG4gICAgICBpZiAoYS5pbmRleCA8IGIuaW5kZXgpIHtcbiAgICAgICAgcmV0dXJuIC0xO1xuICAgICAgfVxuICAgICAgcmV0dXJuIDA7XG4gICAgfSk7XG5cbiAgICAvLyByZWFycmFuZ2UgdGhlIGluZGV4XG4gICAgbGV0IGluZGV4ID0gMDtcbiAgICB0b2RvQXJyLmZvckVhY2goKHRvZG8pID0+IHtcbiAgICAgIGluZGV4ICs9IDE7XG4gICAgICB0b2RvLmluZGV4ID0gaW5kZXg7XG4gICAgfSk7XG5cbiAgICB0aGlzLnRvZG9zID0gWy4uLnRvZG9BcnJdO1xuICAgIGxvY2FsU3RvcmFnZS5zZXRJdGVtKCd0b2RvcycsIEpTT04uc3RyaW5naWZ5KHRoaXMudG9kb3MpKTtcbiAgfTtcblxuICAvLyBSZW5kZXIgdG9kbyBsaXN0XG4gIHJlbmRlciA9ICgpID0+IHtcbiAgICB0b2RvQ29udGFpbmVyLmlubmVySFRNTCA9ICcnO1xuICAgIHNob3dNc2cuaW5uZXJUZXh0ID0gJyc7XG4gICAgc2hvd01zZy5jbGFzc0xpc3QucmVtb3ZlKCdmb3JtLWVycm9yJyk7XG4gICAgdGhpcy5zb3J0QW5kU2F2ZSgpO1xuICAgIGlmICh0aGlzLnRvZG9zLmxlbmd0aCA+IDApIHtcbiAgICAgIHRoaXMudG9kb3MuZm9yRWFjaCgodG9kbykgPT4ge1xuICAgICAgICAvLyBjcmVhdGUgdG9kbyBpdGVtXG4gICAgICAgIGNvbnN0IHRvZG9JdGVtID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnbGknKTtcbiAgICAgICAgdG9kb0l0ZW0uaWQgPSB0b2RvLmluZGV4O1xuICAgICAgICB0b2RvSXRlbS5jbGFzc05hbWUgPSAndG9kby1pdGVtJztcbiAgICAgICAgdG9kb0l0ZW0uc2V0QXR0cmlidXRlKCdkcmFnZ2FibGUnLCB0cnVlKTtcblxuICAgICAgICAvLyBkcmFnIGFuZCBkcm9wIGZ1bmN0aW9uO1xuICAgICAgICB0b2RvSXRlbS5hZGRFdmVudExpc3RlbmVyKCdkcmFnc3RhcnQnLCAoKSA9PiB7XG4gICAgICAgICAgdG9kb0l0ZW0uY2xhc3NMaXN0LmFkZCgnZHJhZ2dpbmcnKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgdG9kb0l0ZW0uYWRkRXZlbnRMaXN0ZW5lcignZHJhZ2VuZCcsICgpID0+IHtcbiAgICAgICAgICB0b2RvSXRlbS5jbGFzc0xpc3QucmVtb3ZlKCdkcmFnZ2luZycpO1xuICAgICAgICAgIGNvbnN0IHRvZG9JdGVtc0FmdGVyRHJhZyA9IHRvZG9Db250YWluZXIucXVlcnlTZWxlY3RvckFsbCgnLnRvZG8taXRlbScpO1xuICAgICAgICAgIGNvbnN0IG5ld1RvZG9zID0gW107XG4gICAgICAgICAgdG9kb0l0ZW1zQWZ0ZXJEcmFnLmZvckVhY2goKGl0ZW0pID0+IHtcbiAgICAgICAgICAgIGNvbnN0IGlkID0gaXRlbS5nZXRBdHRyaWJ1dGUoJ2lkJyk7XG4gICAgICAgICAgICBjb25zdCBmaW5kaXRlbSA9IHRoaXMudG9kb3MuZmluZCgodCkgPT4gdC5pbmRleCA9PT0gK2lkKTtcbiAgICAgICAgICAgIGlmIChmaW5kaXRlbSkge1xuICAgICAgICAgICAgICBuZXdUb2Rvcy5wdXNoKGZpbmRpdGVtKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9KTtcbiAgICAgICAgICAvLyByZWFycmFuZ2UgdGhlIGluZGV4XG4gICAgICAgICAgbGV0IGluZGV4ID0gMDtcbiAgICAgICAgICBuZXdUb2Rvcy5mb3JFYWNoKCh0b2RvKSA9PiB7XG4gICAgICAgICAgICBpbmRleCArPSAxO1xuICAgICAgICAgICAgdG9kby5pbmRleCA9IGluZGV4O1xuICAgICAgICAgIH0pO1xuICAgICAgICAgIHRoaXMudG9kb3MgPSBuZXdUb2RvcztcbiAgICAgICAgICB0aGlzLnJlbmRlcigpO1xuICAgICAgICB9KTtcblxuICAgICAgICAvLyB0b2RvIGNoZWNrYm94XG4gICAgICAgIGNvbnN0IGNoZWNrYm94ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnaW5wdXQnKTtcbiAgICAgICAgY2hlY2tib3guc2V0QXR0cmlidXRlKCd0eXBlJywgJ2NoZWNrYm94Jyk7XG4gICAgICAgIGNoZWNrYm94LmlkID0gJ3RvZG8tY29tcGxlYXRlJztcblxuICAgICAgICBjaGVja2JveC5hZGRFdmVudExpc3RlbmVyKCdjaGFuZ2UnLCAoZSkgPT4ge1xuICAgICAgICAgIHRoaXMub25Db21wbGVhdGUoZSk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIC8vIHRvZG8gZGVzY3JpcHRpb25cbiAgICAgICAgY29uc3QgdG9kb0RlcyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3AnKTtcbiAgICAgICAgdG9kb0Rlcy5jbGFzc05hbWUgPSAndG9kby1kZXMnO1xuICAgICAgICB0b2RvRGVzLmlubmVyVGV4dCA9IHRvZG8uZGVzY3JpcHRpb247XG5cbiAgICAgICAgaWYgKHRvZG8uY29tcGxldGVkKSB7XG4gICAgICAgICAgY2hlY2tib3guc2V0QXR0cmlidXRlKCdjaGVja2VkJywgJ3llcycpO1xuICAgICAgICAgIHRvZG9EZXMuY2xhc3NMaXN0LmFkZCgndG9kby1jb21wbGVhdGVkJyk7XG4gICAgICAgIH1cblxuICAgICAgICAvLyB0b2RvIFRocmVlIGRvdCBidXR0b25cbiAgICAgICAgY29uc3QgdGhyZWVEb3RCdXR0b24gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdidXR0b24nKTtcbiAgICAgICAgdGhyZWVEb3RCdXR0b24uY2xhc3NOYW1lID0gJ2J0bi10aHJlZS1kb3QnO1xuICAgICAgICB0aHJlZURvdEJ1dHRvbi5pbm5lckhUTUwgPSBgPGltZyBzcmM9XCIke3RocmVlRG90SWNvbn1cIiBhbHQ9XCIuLi5cIj5gO1xuXG4gICAgICAgIC8vIGFkZCBldmVudCBvbiB0aHJlZSBpY29uIGZvciBlZGl0IGFuZCBkZWxldGUuXG4gICAgICAgIHRocmVlRG90QnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKGUpID0+IHtcbiAgICAgICAgICB0aGlzLm9uQ2xpY2tUb2RvRGVzKGUpO1xuICAgICAgICB9KTtcblxuICAgICAgICAvLyBBcHBlbmQgYWxsIHRoZSB0b2RvIGVsZW1lbnRzIGluc2lkZSB0aGUgdG9kb0l0ZW1zXG4gICAgICAgIHRvZG9JdGVtLmFwcGVuZChjaGVja2JveCwgdG9kb0RlcywgdGhyZWVEb3RCdXR0b24pO1xuXG4gICAgICAgIC8vIGFwcGVudCB0aGUgdG9kbyBpdGVtIGluc2lkZSB0b2RvQ29udGFpbmVyXG4gICAgICAgIHRvZG9Db250YWluZXIuYXBwZW5kQ2hpbGQodG9kb0l0ZW0pO1xuICAgICAgfSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRvZG9Db250YWluZXIuaW5uZXJIVE1MID0gJzxwIGNsYXNzPVwibm8taXRlbVwiPlRoZXJlIGlzIG5vIHRvZG8gdG8gc2hvdyEgUGxlYXNlIGFkZCBhIG5ldyBvbmUuPC9wPic7XG4gICAgfVxuICB9O1xuXG4gIC8vIG9uU3VibWl0IG1ldGhvZFxuICBvblN1Ym1pdCA9ICgpID0+IHtcbiAgICAvLyBWYWxpZGF0ZSB0aGUgZm9ybVxuICAgIGNvbnN0IGRlc2NyaXB0aW9uID0gZm9ybUlucHV0LnZhbHVlO1xuICAgIGNvbnN0IHJlcXVpcmVkID0gdHJ1ZTtcbiAgICBjb25zdCBtaW5MZW5ndGggPSAzO1xuICAgIGNvbnN0IG1heExlbmd0aCA9IDI1NTtcbiAgICBjb25zdCBzcGVjaWFsQ2hhciA9IGZhbHNlO1xuICAgIGNvbnN0IGlzVmFsaWQgPSB2YWxpZGF0ZUZvcm0oXG4gICAgICBkZXNjcmlwdGlvbixcbiAgICAgIHJlcXVpcmVkLFxuICAgICAgbWluTGVuZ3RoLFxuICAgICAgbWF4TGVuZ3RoLFxuICAgICAgc3BlY2lhbENoYXIsXG4gICAgKTtcblxuICAgIC8vIENoZWNrIGlmIGZvcm0gaGFzIGVycm9yIG9yIG5vdFxuXG4gICAgaWYgKGlzVmFsaWQuaXNFcnJvciA9PT0gdHJ1ZSAmJiBpc1ZhbGlkLm1zZy5sZW5ndGggPj0gMCkge1xuICAgICAgc2hvd01zZy5jbGFzc0xpc3QuYWRkKCdmb3JtLWVycm9yJyk7XG4gICAgICBzaG93TXNnLnRleHRDb250ZW50ID0gaXNWYWxpZC5tc2c7XG4gICAgICBmb3JtSW5wdXQuY2xhc3NMaXN0LmFkZCgnaW52YWxpZCcpO1xuICAgIH0gZWxzZSB7XG4gICAgICAvLyBpZiBmb3JtIGlzIGVtcHR5IGFkZCBhIG5ldyB0b2RvXG4gICAgICBzaG93TXNnLmNsYXNzTGlzdC5yZW1vdmUoJ2Zvcm0tZXJyb3InKTtcbiAgICAgIHNob3dNc2cudGV4dENvbnRlbnQgPSAnJztcbiAgICAgIGZvcm1JbnB1dC5jbGFzc0xpc3QucmVtb3ZlKCdpbnZhbGlkJyk7XG4gICAgICBmb3JtSW5wdXQudmFsdWUgPSAnJztcbiAgICAgIGNvbnN0IGluZGV4ID0gdGhpcy50b2Rvcy5sZW5ndGggKyAxIHx8IDE7XG4gICAgICBjb25zdCB0b2RvID0ge1xuICAgICAgICBkZXNjcmlwdGlvbixcbiAgICAgICAgY29tcGxldGVkOiBmYWxzZSxcbiAgICAgICAgaW5kZXgsXG4gICAgICB9O1xuICAgICAgdGhpcy50b2RvcyA9IFsuLi50aGlzLnRvZG9zLCB0b2RvXTtcbiAgICAgIC8vIHJlbmRlciB0aGUgbmV3IHRvZG9zIG9uIHRoZSBkb21cbiAgICAgIHRoaXMucmVuZGVyKCk7XG4gICAgfVxuICB9O1xuXG4gIGRlbGV0ZSA9IChpbmRleCkgPT4ge1xuICAgIHRoaXMudG9kb3MgPSB0aGlzLnRvZG9zLmZpbHRlcigodCkgPT4gdC5pbmRleC50b1N0cmluZygpICE9PSBpbmRleCk7XG4gICAgdGhpcy5yZW5kZXIoKTtcbiAgfTtcblxuICAvLyBlZGl0IHRvZG9cbiAgZWRpdCA9IChlKSA9PiB7XG4gICAgY29uc3QgeyB2YWx1ZSB9ID0gZS50YXJnZXQ7XG5cbiAgICAvLyB2YWxpZGF0ZSBmb3JtXG4gICAgY29uc3QgcmVxdWlyZWQgPSB0cnVlO1xuICAgIGNvbnN0IG1pbkxlbmd0aCA9IDM7XG4gICAgY29uc3QgbWF4TGVuZ3RoID0gMjU1O1xuICAgIGNvbnN0IHNwZWNpYWxDaGFyID0gZmFsc2U7XG4gICAgY29uc3QgaXNWYWxpZCA9IHZhbGlkYXRlRm9ybShcbiAgICAgIHZhbHVlLFxuICAgICAgcmVxdWlyZWQsXG4gICAgICBtaW5MZW5ndGgsXG4gICAgICBtYXhMZW5ndGgsXG4gICAgICBzcGVjaWFsQ2hhcixcbiAgICApO1xuICAgIGlmIChpc1ZhbGlkLmlzRXJyb3IgPT09IHRydWUgJiYgaXNWYWxpZC5tc2cubGVuZ3RoID4gMCkge1xuICAgICAgc2hvd01zZy5jbGFzc0xpc3QuYWRkKCdmb3JtLWVycm9yJyk7XG4gICAgICBzaG93TXNnLnRleHRDb250ZW50ID0gaXNWYWxpZC5tc2c7XG4gICAgICBlLnRhcmdldC5jbGFzc0xpc3QuYWRkKCdpbnZhbGlkLWVkaXQnKTtcbiAgICB9IGVsc2Uge1xuICAgICAgZS50YXJnZXQuY2xhc3NMaXN0LnJlbW92ZSgnaW52YWxpZC1lZGl0Jyk7XG4gICAgICBjb25zdCBpbmRleCA9IGUudGFyZ2V0LnBhcmVudEVsZW1lbnQuaWQ7XG4gICAgICBjb25zdCBuZXdBcnIgPSBbLi4udGhpcy50b2Rvc107XG4gICAgICBjb25zdCBpbmR4ID0gbmV3QXJyLmZpbmRJbmRleCgoaXRlbSkgPT4gaW5kZXggPT09IGl0ZW0uaW5kZXgudG9TdHJpbmcoKSk7XG4gICAgICBpZiAoaW5keCA+PSAwKSB7XG4gICAgICAgIG5ld0FycltpbmR4XS5kZXNjcmlwdGlvbiA9IHZhbHVlO1xuICAgICAgfVxuICAgICAgdGhpcy50b2RvcyA9IFsuLi5uZXdBcnJdO1xuICAgICAgdGhpcy5yZW5kZXIoKTtcbiAgICB9XG4gIH07XG5cbiAgLy8gb25DbGlja0RlcyBlbmVudCBtZXRob2RcbiAgb25DbGlja1RvZG9EZXMgPSAoZSkgPT4ge1xuICAgIC8vIHRhcmdldC5vdXRlckhUTUwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCd0ZXh0YXJlYScpO1xuICAgIGNvbnN0IHBhcmVudCA9IGUudGFyZ2V0LnBhcmVudEVsZW1lbnQucGFyZW50RWxlbWVudDtcbiAgICBjb25zdCBnZXRUb3RvZGVzID0gcGFyZW50LnF1ZXJ5U2VsZWN0b3IoJy50b2RvLWRlcycpLmlubmVyVGV4dDtcbiAgICBwYXJlbnQuaW5uZXJIVE1MID0gJyc7XG5cbiAgICAvLyB0b2RvIGNoZWNrYm94XG4gICAgY29uc3QgY2hlY2tib3ggPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdpbnB1dCcpO1xuICAgIGNoZWNrYm94LnNldEF0dHJpYnV0ZSgndHlwZScsICdjaGVja2JveCcpO1xuICAgIGNoZWNrYm94LmlkID0gJ3RvZG8tY29tcGxlYXRlJztcblxuICAgIGNoZWNrYm94LmFkZEV2ZW50TGlzdGVuZXIoJ2NoYW5nZScsIChlKSA9PiB7XG4gICAgICB0aGlzLm9uQ29tcGxlYXRlKGUpO1xuICAgIH0pO1xuXG4gICAgLy8gdG9kbyBkZXNjcmlwdGlvblxuICAgIGNvbnN0IHRvZG9FZGl0SW5wdXQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdpbnB1dCcpO1xuICAgIHRvZG9FZGl0SW5wdXQuc2V0QXR0cmlidXRlKCd0eXBlJywgJ3RleHQnKTtcbiAgICB0b2RvRWRpdElucHV0LnNldEF0dHJpYnV0ZSgndmFsdWUnLCBnZXRUb3RvZGVzKTtcbiAgICB0b2RvRWRpdElucHV0LmNsYXNzTmFtZSA9ICd0b2RvLWVkaXQtaW5wdXQnO1xuXG4gICAgLy8gQWRkIGV2ZW50IG9uIGtleXByZXNzIGluIHRoZSB0ZXh0YXJlYVxuICAgIHRvZG9FZGl0SW5wdXQuYWRkRXZlbnRMaXN0ZW5lcigna2V5cHJlc3MnLCAoZSkgPT4ge1xuICAgICAgaWYgKGUua2V5ID09PSAnRW50ZXInKSB7XG4gICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgdGhpcy5lZGl0KGUpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgc2hvd01zZy5jbGFzc0xpc3QucmVtb3ZlKCdmb3JtLWVycm9yJyk7XG4gICAgICAgIHNob3dNc2cuaW5uZXJUZXh0ID0gJyc7XG4gICAgICAgIGUudGFyZ2V0LmNsYXNzTGlzdC5yZW1vdmUoJ2ludmFsaWQtZWRpdCcpO1xuICAgICAgfVxuICAgIH0pO1xuXG4gICAgLy8gdG9kbyBEZWxldGUgZG90IGJ1dHRvblxuICAgIGNvbnN0IGRlbGV0ZVRvZG8gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdidXR0b24nKTtcbiAgICBkZWxldGVUb2RvLmNsYXNzTmFtZSA9ICdidG4tZGVsZXRlJztcbiAgICBkZWxldGVUb2RvLmlubmVySFRNTCA9IGA8aW1nIHNyYz1cIiR7ZGVsZXRlSWNvbn1cIiBhbHQ9XCJYXCI+YDtcblxuICAgIC8vIGFkZGluZyBldmVudCBvbiBkZWxldGUgaWNvblxuICAgIGRlbGV0ZVRvZG8uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7XG4gICAgICBjb25zdCBpbmRleCA9IHBhcmVudC5pZDtcbiAgICAgIHRoaXMuZGVsZXRlKGluZGV4KTtcbiAgICB9KTtcblxuICAgIHBhcmVudC5hcHBlbmQoY2hlY2tib3gsIHRvZG9FZGl0SW5wdXQsIGRlbGV0ZVRvZG8pO1xuICB9O1xuXG4gIG9uQ29tcGxlYXRlID0gKGUpID0+IHtcbiAgICBjb25zdCBpbmRleCA9IGUudGFyZ2V0LnBhcmVudEVsZW1lbnQuaWQ7XG4gICAgY29uc3QgbmV3QXJyID0gWy4uLnRoaXMudG9kb3NdO1xuICAgIGNvbnN0IGluZHggPSBuZXdBcnIuZmluZEluZGV4KChpdGVtKSA9PiBpbmRleCA9PT0gaXRlbS5pbmRleC50b1N0cmluZygpKTtcbiAgICBpZiAoaW5keCA+PSAwKSB7XG4gICAgICBuZXdBcnJbaW5keF0uY29tcGxldGVkID0gIW5ld0FycltpbmR4XS5jb21wbGV0ZWQ7XG4gICAgfVxuICAgIHRoaXMudG9kb3MgPSBbLi4ubmV3QXJyXTtcbiAgICB0aGlzLnJlbmRlcigpO1xuICB9O1xuXG4gIG9uRmlsdGVyQ29tcGxldGVkVG9kb3MgPSAoKSA9PiB7XG4gICAgbGV0IG5ld0FyciA9IFsuLi50aGlzLnRvZG9zXTtcbiAgICBuZXdBcnIgPSBuZXdBcnIuZmlsdGVyKChpdGVtKSA9PiBpdGVtLmNvbXBsZXRlZCAhPT0gdHJ1ZSk7XG4gICAgdGhpcy50b2RvcyA9IFsuLi5uZXdBcnJdO1xuICAgIHRoaXMucmVuZGVyKCk7XG4gIH07XG59XG4iLCJpbXBvcnQgJy4vc3R5bGUuY3NzJztcbmltcG9ydCBUb2RvcyBmcm9tICcuL21vZHVsZXMvdG9kb3MuanMnO1xuaW1wb3J0IHtcbiAgZm9ybUlucHV0LFxuICBidG5TdWJtaXQsXG4gIHNob3dNc2csXG4gIGZpbHRlckJ1dHRvbixcbiAgdG9kb0NvbnRhaW5lcixcbn0gZnJvbSAnLi9tb2R1bGVzL2RvbVNlbGVjdG9yLmpzJztcblxuLy8gSW1wb3J0IG5lY2Vzc2FyeSBhc3NldHMgZm9ybSBzb3VyY2VcbmltcG9ydCBlbnRlckljb24gZnJvbSAnLi9hc3NldHMvZW50ZXItMjQucG5nJztcbmltcG9ydCB7IGdldEFmdGVyRWxlbWVudCB9IGZyb20gJy4vbW9kdWxlcy91dGlscy5qcyc7XG5cbi8vIEluaXRpYWxpemUgdGhlIHRvZG9zXG5jb25zdCB0b2RvcyA9IG5ldyBUb2RvcygpO1xuXG4vLyB0b2RvIHN1Ym1pdCBldmVudCB1c2luZyBFbnRlciBidXR0b24uXG5mb3JtSW5wdXQuYWRkRXZlbnRMaXN0ZW5lcigna2V5cHJlc3MnLCAoZSkgPT4ge1xuICBpZiAoZS5rZXkgPT09ICdFbnRlcicpIHtcbiAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgdG9kb3Mub25TdWJtaXQoKTtcbiAgfSBlbHNlIHtcbiAgICBzaG93TXNnLmlubmVySFRNTCA9ICcnO1xuICAgIHNob3dNc2cuY2xhc3NMaXN0LnJlbW92ZSgnZm9ybS1lcnJvcicpO1xuICAgIGZvcm1JbnB1dC5jbGFzc0xpc3QucmVtb3ZlKCdpbnZhbGlkJyk7XG4gIH1cbn0pO1xuXG4vLyB0b2RvIHN1Ym1pdCBldmVudCB1c2luZyBzdWJtaXQgYnV0dG9uXG5idG5TdWJtaXQuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoZSkgPT4ge1xuICBlLnByZXZlbnREZWZhdWx0KCk7XG4gIHRvZG9zLm9uU3VibWl0KCk7XG59KTtcblxuLy8gZmlsdGVyIGFsbCBjb21wbGV0ZWQgbGlzdDtcbmZpbHRlckJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcbiAgdG9kb3Mub25GaWx0ZXJDb21wbGV0ZWRUb2RvcygpO1xufSk7XG5cbi8vIGRyYWcgb3ZlciBlbmVudDtcbnRvZG9Db250YWluZXIuYWRkRXZlbnRMaXN0ZW5lcignZHJhZ292ZXInLCAoZSkgPT4ge1xuICBlLnByZXZlbnREZWZhdWx0KCk7XG4gIGNvbnN0IGdldEFmdGVyRWxlbWVudFBvc2l0aW9uID0gZ2V0QWZ0ZXJFbGVtZW50KHRvZG9Db250YWluZXIsIGUuY2xpZW50WSk7XG4gIGNvbnN0IGRyYWdnaW5nID0gdG9kb0NvbnRhaW5lci5xdWVyeVNlbGVjdG9yKCcuZHJhZ2dpbmcnKTtcblxuICBpZiAoZHJhZ2dpbmcgPT0gbnVsbCkge1xuICAgIHRvZG9Db250YWluZXIuYXBwZW5kQ2hpbGQoZHJhZ2dpbmcpO1xuICB9IGVsc2Uge1xuICAgIHRvZG9Db250YWluZXIuaW5zZXJ0QmVmb3JlKGRyYWdnaW5nLCBnZXRBZnRlckVsZW1lbnRQb3NpdGlvbik7XG4gIH1cbn0pO1xuXG4vLyBMb2FkIHRoZSB0b2RvIGxpc3Qgb24gdGhlIGZseS5cbndpbmRvdy5vbmxvYWQgPSAoKSA9PiB7XG4gIHRvZG9zLnJlbmRlcigpO1xuICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFxuICAgICcuYnRuLXN1Ym1pdCcsXG4gICkuaW5uZXJIVE1MID0gYDxpbWcgc3JjPScke2VudGVySWNvbn0nIGFsdD0nc3VibWl0Jy8+YDtcbn07XG4iXSwibmFtZXMiOlsidmFsaWRhdGVGb3JtIiwic3RyIiwicmVxdWlyZWQiLCJtaW5MZW5ndGgiLCJtYXhMZW5ndGgiLCJzcGVjaWFsQ2hhciIsImlzRXJyb3IiLCJtc2ciLCJsZW4iLCJ0cmltIiwibGVuZ3RoIiwibmV3U3RyIiwicmVwbGFjZSIsInJlIiwidGVzdCIsImZvcm1JbnB1dCIsImRvY3VtZW50IiwiZ2V0RWxlbWVudEJ5SWQiLCJzaG93TXNnIiwicXVlcnlTZWxlY3RvciIsImJ0blN1Ym1pdCIsInRvZG9Db250YWluZXIiLCJmaWx0ZXJCdXR0b24iLCJxdWVyeVNlbGVjdG9yQWxsIiwiVG9kb3MiLCJ0b2RvQXJyIiwidG9kb3MiLCJzb3J0IiwiYSIsImIiLCJpbmRleCIsImZvckVhY2giLCJ0b2RvIiwibG9jYWxTdG9yYWdlIiwic2V0SXRlbSIsIkpTT04iLCJzdHJpbmdpZnkiLCJpbm5lckhUTUwiLCJpbm5lclRleHQiLCJjbGFzc0xpc3QiLCJyZW1vdmUiLCJzb3J0QW5kU2F2ZSIsInRvZG9JdGVtIiwiY3JlYXRlRWxlbWVudCIsImlkIiwiY2xhc3NOYW1lIiwic2V0QXR0cmlidXRlIiwiYWRkRXZlbnRMaXN0ZW5lciIsImFkZCIsInRvZG9JdGVtc0FmdGVyRHJhZyIsIm5ld1RvZG9zIiwiaXRlbSIsImdldEF0dHJpYnV0ZSIsImZpbmRpdGVtIiwiZmluZCIsInQiLCJwdXNoIiwicmVuZGVyIiwiY2hlY2tib3giLCJlIiwib25Db21wbGVhdGUiLCJ0b2RvRGVzIiwiZGVzY3JpcHRpb24iLCJjb21wbGV0ZWQiLCJ0aHJlZURvdEJ1dHRvbiIsInRocmVlRG90SWNvbiIsIm9uQ2xpY2tUb2RvRGVzIiwiYXBwZW5kIiwiYXBwZW5kQ2hpbGQiLCJ2YWx1ZSIsImlzVmFsaWQiLCJ0ZXh0Q29udGVudCIsImZpbHRlciIsInRvU3RyaW5nIiwidGFyZ2V0IiwicGFyZW50RWxlbWVudCIsIm5ld0FyciIsImluZHgiLCJmaW5kSW5kZXgiLCJwYXJlbnQiLCJnZXRUb3RvZGVzIiwidG9kb0VkaXRJbnB1dCIsImtleSIsInByZXZlbnREZWZhdWx0IiwiZWRpdCIsImRlbGV0ZVRvZG8iLCJkZWxldGVJY29uIiwiZ2V0SXRlbSIsInRoaXMiLCJwYXJzZSIsIm9uU3VibWl0Iiwib25GaWx0ZXJDb21wbGV0ZWRUb2RvcyIsImdldEFmdGVyRWxlbWVudFBvc2l0aW9uIiwieSIsInJlZHVjZSIsIm5lYXJlc3QiLCJib3giLCJnZXRCb3VuZGluZ0NsaWVudFJlY3QiLCJvZmZzZXQiLCJ0b3AiLCJoZWlnaHQiLCJlbGVtZW50IiwiTnVtYmVyIiwiTkVHQVRJVkVfSU5GSU5JVFkiLCJnZXRBZnRlckVsZW1lbnQiLCJjbGllbnRZIiwiZHJhZ2dpbmciLCJpbnNlcnRCZWZvcmUiLCJ3aW5kb3ciLCJvbmxvYWQiLCJlbnRlckljb24iXSwic291cmNlUm9vdCI6IiJ9